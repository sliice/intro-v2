{"ast":null,"code":"var _jsxFileName = \"/Users/alisakrylova/Intro2/client/src/components/Students.js\";\nimport React, { useCallback, useContext, useEffect, useState } from 'react';\nimport './Appearence/index.css';\nimport './Appearence/Auth.css';\nimport './Appearence/Students.css';\nimport './Appearence/DatePicker.css';\nimport { useHttp } from \"../Hooks/Http.hook\";\nimport { AuthContext } from \"./Context/AuthContext\";\nimport { emojis, emojiToString } from \"./Functions and const/Emoji\";\nimport RegExps from \"./Functions and const/RegExps\";\nimport { NavLink } from \"react-router-dom\";\nimport DatePicker from \"react-datepicker/es\";\nimport { registerLocale } from \"react-datepicker\";\nimport * as cyrToTranslit from 'cyrillic-to-translit-js';\nimport formatDateToRu from \"./Functions and const/DateFormat\";\nimport notify from './Functions and const/Notify';\nimport showError from './Functions and const/ShowError';\nimport SearchIcon from \"./Appearence/Images/SearchIcon\";\nexport const Students = () => {\n  const {\n    loading,\n    request\n  } = useHttp();\n  const [form, setForm] = useState({\n    login: '',\n    password: '',\n    type: 's',\n    pic: [128522],\n    name: '',\n    surname: '',\n    grade: '',\n    letter: '',\n    birthday: ''\n  });\n  const [errors, setErrors] = useState({\n    name: '',\n    surname: '',\n    login: '',\n    password: ''\n  });\n  const [grades, setGrades] = useState([]);\n  const [shownGrades, setShownGrades] = useState([]);\n  const [search, setSearch] = useState([]);\n  const [notFound, setNotFound] = useState();\n  const [sorted, setSorted] = useState(false);\n  const [isSearching, activateSearching] = useState('none');\n  const [isAdding, activateAdding] = useState('none');\n  const [isChoosingEmoji, activateChoosingEmoji] = useState(false);\n  const [date, setDate] = useState();\n  const {\n    token\n  } = useContext(AuthContext);\n  const months = ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'];\n  const days = ['вс', 'пн', 'вт', 'ср', 'чт', 'пт', 'сб'];\n  registerLocale('ru', {\n    localize: {\n      month: i => months[i],\n      day: i => days[i]\n    },\n    formatLong: {}\n  });\n\n  const changeHandler = e => {\n    e.preventDefault();\n    let login = form.login;\n\n    switch (e.target.name) {\n      case 'grade':\n        let thisYear = new Date().getFullYear();\n        let then = new Date(thisYear - 7 - e.target.value, 0, 1);\n        setDate(then);\n        break;\n\n      case 'surname':\n        login = cyrToTranslit().transform(e.target.value).toString().toLowerCase();\n        break;\n\n      case 'login':\n        login = e.target.value.toString().toLowerCase();\n        break;\n    }\n\n    setForm({ ...form,\n      [e.target.name]: e.target.value,\n      login: login,\n      birthday: date\n    });\n  };\n\n  const checkFields = async e => {\n    e.preventDefault();\n\n    try {\n      if (!(form.name && form.surname && form.grade && form.letter && form.birthday && form.login && form.password)) notify(\"Не все поля заполнены\");\n      let name = '',\n          surname = '',\n          login = '',\n          password = '';\n\n      if (form.name && !RegExps.cyrillicsRegExp.test(form.name)) {\n        name = 'Допустима только из кириллица';\n        await showError(true, 'name', 'errorStudentName');\n      }\n\n      if (form.surname && !RegExps.cyrillicsRegExp.test(form.surname)) {\n        surname = 'Допустима только из кириллица';\n        await showError(true, 'surname', 'errorStudentSurname');\n      }\n\n      if (form.login && !RegExps.loginRegExp.test(form.login)) {\n        login = 'Допустимы только a-z, цифры, точка и пробел';\n        await showError(true, 'login', 'errorStudentLogin');\n      }\n\n      if (form.password && !RegExps.passwordRegExp.test(form.password)) {\n        if (form.password.length < 6 || form.password.length > 20) password = 'Пароль должен содержать от 6 до 20 символов';else password = 'Допустимы только A-z, цифры, точка и пробел';\n        await showError(true, 'password', 'errorStudentPassword');\n      }\n\n      !name && (await showError(false, 'name', 'errorStudentName'));\n      !surname && (await showError(false, 'surname', 'errorStudentSurname'));\n      !login && (await showError(false, 'login', 'errorStudentLogin'));\n      !password && (await showError(false, 'password', 'errorStudentPassword'));\n      setErrors({\n        name,\n        surname,\n        login,\n        password\n      });\n      if (!name && !surname && !login && !password) return true;else return false;\n    } catch (e) {}\n  };\n\n  const setBirthday = birthday => {\n    setDate(birthday);\n    setForm({ ...form,\n      birthday: birthday\n    });\n  };\n\n  const registerHandler = async e => {\n    e.preventDefault();\n\n    try {\n      if (await checkFields(e)) {\n        const data = await request('/api/students/create', 'POST', { ...form\n        });\n        console.log(data.message);\n\n        if (data.message === 'User\\'ve created') {\n          notify('Пользователь создан');\n          setForm({\n            login: '',\n            password: '',\n            type: 's',\n            pic: [128522],\n            name: '',\n            surname: '',\n            grade: '',\n            letter: '',\n            birthday: ''\n          });\n        } else if (data.message === 'This user already exists') {\n          notify('Пользователь с таким логином уже существует');\n        }\n      }\n    } catch (e) {}\n  };\n\n  const fetchGrades = useCallback(async () => {\n    try {\n      const fetched = await request('/api/students', 'GET', null, {\n        Authorization: `Bearer ${token}`\n      });\n      fetched.sort((a, b) => a.grade > b.grade ? 1 : -1);\n      setGrades(fetched);\n    } catch (e) {}\n  }, [token, request]);\n\n  const handleSearchActivating = e => {\n    e.preventDefault();\n\n    switch (isSearching) {\n      case 'active':\n        activateSearching('inactive');\n        break;\n\n      case 'none':\n      case 'inactive':\n        activateSearching('active');\n        document.getElementById('search').focus();\n        break;\n    }\n  };\n\n  const doSearch = e => {\n    e.preventDefault();\n\n    try {\n      let searchFilter = e.target.value.toString().toLowerCase();\n      setSearch(searchFilter);\n      setNotFound(false);\n\n      if (searchFilter != '') {\n        let gradesArray = [];\n        grades.map(grade => {\n          let studentsArray = [];\n          grade.students.map(student => {\n            studentsArray.push((student.name + student.surname).toString().toLowerCase());\n          });\n          gradesArray.push((grade.grade + grade.letter + studentsArray).toString().toLowerCase());\n        });\n        let indexes = [];\n        gradesArray.map((grade, i) => {\n          if (grade.toString().includes(searchFilter)) indexes.push(i);\n        });\n\n        if (indexes.length != 0) {\n          setShownGrades([...indexes]);\n          setNotFound(false);\n        } else setNotFound(true);\n      } else showAll();\n    } catch (e) {}\n  };\n\n  const doSort = e => {\n    e.preventDefault();\n\n    try {\n      switch (sorted) {\n        case true:\n          document.getElementById('sortIcon').style = 'transform: rotate(360deg);';\n          document.getElementById('gradesCollection').style = 'flex-direction: column;';\n          setSorted(false);\n          break;\n\n        case false:\n          document.getElementById('sortIcon').style = 'transform: rotate(180deg);';\n          document.getElementById('gradesCollection').style = 'flex-direction: column-reverse;';\n          setSorted(true);\n          break;\n      }\n    } catch (e) {}\n  };\n\n  const handleAddActivating = e => {\n    e.preventDefault();\n\n    switch (isAdding) {\n      case 'active':\n        activateAdding('inactive');\n        document.getElementById('label').className = 'addingPanelAppearing';\n        document.getElementById('gradesCollection').className = 'addingPanelAppearing gradesCollection';\n        document.getElementById('addingStudent').className = 'gradesDisappearing addingStudent';\n        break;\n\n      case 'none':\n      case 'inactive':\n        activateAdding('active');\n        document.getElementById('label').className = 'addingPanelDisappearing';\n        document.getElementById('gradesCollection').className = 'addingPanelDisappearing gradesCollection';\n        document.getElementById('addingStudent').className = 'gradesAppearing addingStudent';\n        break;\n    }\n  };\n\n  const handleChooseEmojiActivating = e => {\n    e.preventDefault();\n    activateChoosingEmoji(!isChoosingEmoji);\n  };\n\n  const setFormPic = e => {\n    e.preventDefault();\n    setForm({ ...form,\n      pic: emojis[e.target.id.slice(1)]\n    });\n  };\n\n  const showAll = () => {\n    let shownSize = [];\n\n    for (let i = 0; i < grades.length; i++) {\n      shownSize.push(i);\n    }\n\n    setShownGrades([...shownSize]);\n  };\n\n  const changeGrade = async (e, k) => {\n    e.preventDefault();\n\n    try {\n      const data = await request(`/api/students/grade/${k}`, 'GET', null, {\n        Authorization: `Bearer ${token}`\n      });\n\n      if (data.message === 'Grade have changed') {\n        if (k == 1) notify('Класс всех учеников повышен');else if (k == -1) notify('Класс всех учеников понижен');\n        fetchGrades(e);\n      }\n    } catch (e) {}\n  };\n\n  useEffect(() => {\n    if (grades.length == 0) fetchGrades();\n    document.body.style = 'transition-duration: .5s; transition-timing-function: ease-in-out; background: white;';\n    document.title = 'Ученики';\n    if (shownGrades.length == 0) showAll();\n  }, [fetchGrades, shownGrades, showAll]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    id: \"label\",\n    className: \"soft_appearing\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 13\n    }\n  }, \"\\u0423\\u0447\\u0435\\u043D\\u0438\\u043A\\u0438\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"searchSortAndAdd\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"search\",\n    className: isSearching === 'active' && 'searchAppearing' || isSearching === 'inactive' && 'searchDisappearing' || isSearching === 'none' && 'invisible',\n    placeholder: \"\\u041F\\u043E\\u0438\\u0441\\u043A \\u043F\\u043E \\u0443\\u0447\\u0435\\u043D\\u0438\\u043A\\u0430\\u043C \\u0438 \\u043A\\u043B\\u0430\\u0441\\u0441\\u0430\\u043C\",\n    onChange: e => doSearch(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 17\n    }\n  }), SearchIcon({\n    isSearching,\n    handleSearchActivating\n  }), /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"sortIcon\",\n    id: \"sortIcon\",\n    onClick: e => doSort(e),\n    width: \"378px\",\n    height: \"282px\",\n    viewBox: \"0 0 378 282\",\n    version: \"1.1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Logo\",\n    stroke: \"none\",\n    \"stroke-width\": \"1\",\n    fill: \"none\",\n    \"fill-rule\": \"evenodd\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M96.0389392,1 C106.609669,1 115.859436,5.58308193 120.9273,12.4308996 L121.015825,12.5525321 L184.479,88.185 L184.496508,88.1714212 C184.642609,88.3378163 184.787245,88.5063032 184.930373,88.6768766 C194.515421,100.099893 193.711394,116.554722 183.134527,125.429767 C172.70048,134.184972 156.653546,132.29306 147.020097,121.273869 L146.992363,121.296357 L121.038,90.365 L121.038939,199 L121.03148,199 C121.036443,199.221378 121.038939,199.443416 121.038939,199.666084 C121.038939,214.577772 109.846058,226.666084 96.0389392,226.666084 C82.2318205,226.666084 71.0389392,214.577772 71.0389392,199.666084 C71.0389392,199.443416 71.041435,199.221378 71.0463979,199 L71.0389392,199 L71.038,90.942 L46.409,120.293 L46.4188636,120.301213 C46.2803665,120.473988 46.1395549,120.645684 45.9964268,120.816257 C36.4113784,132.239273 20.0669169,134.304812 9.49005029,125.429767 C-0.91459931,116.699229 -1.8620698,100.633732 7.23426161,89.2388073 L7.21214233,89.2211541 L69.5356122,14.9464184 C74.0533978,6.728782 84.2205763,1 96.0389392,1 Z\",\n    id: \"Combined-Shape\",\n    stroke: \"#4A4A4A\",\n    fill: \"#4A4A4A\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M282.185638,55 C294.279566,55 304.644412,60.9990492 308.99572,69.5252612 L370.259061,142.536 L370.296508,142.505337 C370.442609,142.671732 370.587245,142.840219 370.730373,143.010793 C380.315421,154.433809 379.511394,170.888638 368.934527,179.763683 C358.495096,188.523405 342.436985,186.625021 332.805192,175.590722 L332.757304,175.630273 L306.803061,144.699 L306.80388,253.333916 L306.796421,253.333916 C306.801384,253.555294 306.80388,253.777332 306.80388,254 C306.80388,268.911688 295.610999,281 281.80388,281 C267.996761,281 256.80388,268.911688 256.80388,254 C256.80388,253.777332 256.806376,253.555294 256.811339,253.333916 L256.80388,253.333916 L256.803061,145.276 L232.172061,174.629 L232.179924,174.635129 C232.041427,174.807904 231.900616,174.9796 231.757488,175.150173 C222.172439,186.573189 205.827978,188.638728 195.251111,179.763683 C184.845967,171.03273 183.898901,154.96612 192.99662,143.571098 L192.977083,143.55507 L255.890594,68.5762614 C260.507198,60.5572584 270.545545,55 282.185638,55 Z\",\n    id: \"Combined-Shape-Copy-10\",\n    stroke: \"#D6D6D6\",\n    fill: \"#D6D6D6\",\n    transform: \"translate(282.092819, 168.000000) rotate(180.000000) translate(-282.092819, -168.000000) \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 25\n    }\n  })))), notFound && /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"notFound\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 30\n    }\n  }, \"\\u041D\\u0438\\u0447\\u0435\\u0433\\u043E \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E\"), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"gradesCollection\",\n    className: \"gradesCollection\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 13\n    }\n  }, !notFound && grades && grades.map((grade, index) => {\n    if (shownGrades.includes(index)) return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"gradeItem gradesAppearing\",\n      key: index,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: \"grade\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 362,\n        columnNumber: 37\n      }\n    }, grade.grade, grade.letter), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"students\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 37\n      }\n    }, grade.students.map((student, i) => {\n      if (/\\d/.test(search) || (student.name + student.surname).toString().toLowerCase().includes(search)) return /*#__PURE__*/React.createElement(NavLink, {\n        to: '/profile/' + student.username,\n        key: i,\n        className: \"studentItem soft_appearing\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 53\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"nameAndSurname\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 57\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 61\n        }\n      }, student.name, \" \", student.surname)), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"pic\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 57\n        }\n      }, emojiToString(student.pic)));\n    })));\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"addingStudent\",\n    id: \"addingStudent\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 383,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"addingStudentEmoji\",\n    onClick: e => handleChooseEmojiActivating(e),\n    disabled: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 385,\n      columnNumber: 17\n    }\n  }, emojiToString(form.pic)), isChoosingEmoji && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"emojiContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 21\n    }\n  }, emojis.map((emoji, i) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"addingStudentEmoji\",\n      onClick: e => setFormPic(e),\n      key: i,\n      id: 'e' + i,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 37\n      }\n    }, emojiToString(emoji));\n  })), !isChoosingEmoji && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"addingStudentFormInputs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"name\",\n    name: \"name\",\n    placeholder: \"\\u0418\\u043C\\u044F\",\n    onChange: e => changeHandler(e),\n    value: form.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 407,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"error\",\n    id: \"errorStudentName\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 409,\n      columnNumber: 21\n    }\n  }, errors.name), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"surname\",\n    name: \"surname\",\n    placeholder: \"\\u0424\\u0430\\u043C\\u0438\\u043B\\u0438\\u044F\",\n    onChange: e => changeHandler(e),\n    value: form.surname,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"error\",\n    id: \"errorStudentSurname\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 21\n    }\n  }, errors.surname), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"gradeAndLetter\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 413,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"select\", {\n    name: \"grade\",\n    defaultValue: \"\",\n    onChange: e => changeHandler(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\",\n    disabled: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 21\n    }\n  }, \"\\u041A\\u043B\\u0430\\u0441\\u0441\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 416,\n      columnNumber: 21\n    }\n  }, \"1\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 21\n    }\n  }, \"2\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 418,\n      columnNumber: 21\n    }\n  }, \"3\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 21\n    }\n  }, \"4\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 21\n    }\n  }, \"5\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 421,\n      columnNumber: 21\n    }\n  }, \"6\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"7\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 422,\n      columnNumber: 21\n    }\n  }, \"7\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"8\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 21\n    }\n  }, \"8\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"9\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 424,\n      columnNumber: 21\n    }\n  }, \"9\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 21\n    }\n  }, \"10\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"11\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 426,\n      columnNumber: 21\n    }\n  }, \"11\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 428,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"select\", {\n    id: \"letter\",\n    name: \"letter\",\n    defaultValue: \"\",\n    onChange: e => changeHandler(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\",\n    disabled: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 430,\n      columnNumber: 21\n    }\n  }, \"\\u0411\\u0443\\u043A\\u0432\\u0430\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\\u0410\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 21\n    }\n  }, \"\\u0410\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\\u0411\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 432,\n      columnNumber: 21\n    }\n  }, \"\\u0411\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\\u0412\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 433,\n      columnNumber: 21\n    }\n  }, \"\\u0412\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\\u0413\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 434,\n      columnNumber: 21\n    }\n  }, \"\\u0413\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\\u0414\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 435,\n      columnNumber: 21\n    }\n  }, \"\\u0414\"))), /*#__PURE__*/React.createElement(DatePicker, {\n    selected: date,\n    value: formatDateToRu(date),\n    onChange: date => setBirthday(date),\n    placeholderText: \"\\u0414\\u0430\\u0442\\u0430 \\u0440\\u043E\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F\",\n    locale: \"ru\",\n    dateFormat: \"dd/MM/yyyy\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 439,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"login\",\n    name: \"login\",\n    placeholder: \"\\u041B\\u043E\\u0433\\u0438\\u043D\",\n    onChange: e => changeHandler(e),\n    value: form.login,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 445,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"error\",\n    id: \"errorStudentLogin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 21\n    }\n  }, errors.login), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"password\",\n    name: \"password\",\n    placeholder: \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",\n    onChange: e => changeHandler(e),\n    value: form.password,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 447,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"error\",\n    id: \"errorStudentPassword\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 21\n    }\n  }, errors.password), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"longGreenBtn\",\n    onClick: e => registerHandler(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 450,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 451,\n      columnNumber: 25\n    }\n  }, \"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\")))), !notFound && grades && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flexboxRow soft_appearing\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 459,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"longGrayBtn\",\n    onClick: e => changeGrade(e, -1),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 460,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 461,\n      columnNumber: 25\n    }\n  }, \"\\u041F\\u043E\\u043D\\u0438\\u0437\\u0438\\u0442\\u044C \\u043A\\u043B\\u0430\\u0441\\u0441\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"longGreenBtn\",\n    onClick: e => changeGrade(e, 1),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 463,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 464,\n      columnNumber: 25\n    }\n  }, \"\\u041F\\u043E\\u0432\\u044B\\u0441\\u0438\\u0442\\u044C \\u043A\\u043B\\u0430\\u0441\\u0441\"))));\n};\nexport default Students;","map":{"version":3,"sources":["/Users/alisakrylova/Intro2/client/src/components/Students.js"],"names":["React","useCallback","useContext","useEffect","useState","useHttp","AuthContext","emojis","emojiToString","RegExps","NavLink","DatePicker","registerLocale","cyrToTranslit","formatDateToRu","notify","showError","SearchIcon","Students","loading","request","form","setForm","login","password","type","pic","name","surname","grade","letter","birthday","errors","setErrors","grades","setGrades","shownGrades","setShownGrades","search","setSearch","notFound","setNotFound","sorted","setSorted","isSearching","activateSearching","isAdding","activateAdding","isChoosingEmoji","activateChoosingEmoji","date","setDate","token","months","days","localize","month","i","day","formatLong","changeHandler","e","preventDefault","target","thisYear","Date","getFullYear","then","value","transform","toString","toLowerCase","checkFields","cyrillicsRegExp","test","loginRegExp","passwordRegExp","length","setBirthday","registerHandler","data","console","log","message","fetchGrades","fetched","Authorization","sort","a","b","handleSearchActivating","document","getElementById","focus","doSearch","searchFilter","gradesArray","map","studentsArray","students","student","push","indexes","includes","showAll","doSort","style","handleAddActivating","className","handleChooseEmojiActivating","setFormPic","id","slice","shownSize","changeGrade","k","body","title","index","username","emoji"],"mappings":";AAAA,OAAOA,KAAP,IAAeC,WAAf,EAA4BC,UAA5B,EAAwCC,SAAxC,EAAmDC,QAAnD,QAAkE,OAAlE;AACA,OAAO,wBAAP;AACA,OAAO,uBAAP;AACA,OAAO,2BAAP;AACA,OAAO,6BAAP;AACA,SAAQC,OAAR,QAAsB,oBAAtB;AACA,SAAQC,WAAR,QAA0B,uBAA1B;AACA,SAAQC,MAAR,EAAgBC,aAAhB,QAAoC,6BAApC;AACA,OAAOC,OAAP,MAAoB,+BAApB;AACA,SAAQC,OAAR,QAAsB,kBAAtB;AACA,OAAOC,UAAP,MAAuB,qBAAvB;AACA,SAAQC,cAAR,QAA6B,kBAA7B;AACA,OAAO,KAAKC,aAAZ,MAA+B,yBAA/B;AACA,OAAOC,cAAP,MAA2B,kCAA3B;AACA,OAAOC,MAAP,MAAmB,8BAAnB;AACA,OAAOC,SAAP,MAAsB,iCAAtB;AACA,OAAOC,UAAP,MAAuB,gCAAvB;AAGA,OAAO,MAAMC,QAAQ,GAAG,MAAM;AAE1B,QAAM;AAACC,IAAAA,OAAD;AAAUC,IAAAA;AAAV,MAAqBf,OAAO,EAAlC;AAEA,QAAM,CAACgB,IAAD,EAAOC,OAAP,IAAkBlB,QAAQ,CAAC;AAC7BmB,IAAAA,KAAK,EAAE,EADsB;AAE7BC,IAAAA,QAAQ,EAAE,EAFmB;AAG7BC,IAAAA,IAAI,EAAE,GAHuB;AAI7BC,IAAAA,GAAG,EAAE,CAAC,MAAD,CAJwB;AAK7BC,IAAAA,IAAI,EAAE,EALuB;AAM7BC,IAAAA,OAAO,EAAE,EANoB;AAO7BC,IAAAA,KAAK,EAAE,EAPsB;AAQ7BC,IAAAA,MAAM,EAAE,EARqB;AAS7BC,IAAAA,QAAQ,EAAE;AATmB,GAAD,CAAhC;AAWA,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsB7B,QAAQ,CAAC;AACjCuB,IAAAA,IAAI,EAAE,EAD2B;AAEjCC,IAAAA,OAAO,EAAE,EAFwB;AAGjCL,IAAAA,KAAK,EAAE,EAH0B;AAIjCC,IAAAA,QAAQ,EAAE;AAJuB,GAAD,CAApC;AAMA,QAAM,CAACU,MAAD,EAASC,SAAT,IAAsB/B,QAAQ,CAAC,EAAD,CAApC;AACA,QAAM,CAACgC,WAAD,EAAcC,cAAd,IAAgCjC,QAAQ,CAAC,EAAD,CAA9C;AACA,QAAM,CAACkC,MAAD,EAASC,SAAT,IAAsBnC,QAAQ,CAAC,EAAD,CAApC;AACA,QAAM,CAACoC,QAAD,EAAWC,WAAX,IAA0BrC,QAAQ,EAAxC;AACA,QAAM,CAACsC,MAAD,EAASC,SAAT,IAAsBvC,QAAQ,CAAC,KAAD,CAApC;AACA,QAAM,CAACwC,WAAD,EAAcC,iBAAd,IAAmCzC,QAAQ,CAAC,MAAD,CAAjD;AACA,QAAM,CAAC0C,QAAD,EAAWC,cAAX,IAA6B3C,QAAQ,CAAC,MAAD,CAA3C;AACA,QAAM,CAAC4C,eAAD,EAAkBC,qBAAlB,IAA2C7C,QAAQ,CAAC,KAAD,CAAzD;AACA,QAAM,CAAC8C,IAAD,EAAOC,OAAP,IAAkB/C,QAAQ,EAAhC;AACA,QAAM;AAACgD,IAAAA;AAAD,MAAUlD,UAAU,CAACI,WAAD,CAA1B;AAGA,QAAM+C,MAAM,GAAG,CAAC,QAAD,EAAW,SAAX,EAAsB,MAAtB,EAA8B,QAA9B,EAAwC,KAAxC,EAA+C,MAA/C,EAAuD,MAAvD,EAA+D,QAA/D,EAAyE,UAAzE,EAAqF,SAArF,EAAgG,QAAhG,EAA0G,SAA1G,CAAf;AACA,QAAMC,IAAI,GAAG,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,EAAmB,IAAnB,EAAyB,IAAzB,EAA+B,IAA/B,EAAqC,IAArC,CAAb;AAEA1C,EAAAA,cAAc,CAAC,IAAD,EAAO;AACjB2C,IAAAA,QAAQ,EAAE;AACNC,MAAAA,KAAK,EAAEC,CAAC,IAAIJ,MAAM,CAACI,CAAD,CADZ;AAENC,MAAAA,GAAG,EAAED,CAAC,IAAIH,IAAI,CAACG,CAAD;AAFR,KADO;AAKjBE,IAAAA,UAAU,EAAC;AALM,GAAP,CAAd;;AAQA,QAAMC,aAAa,GAAGC,CAAC,IAAI;AACvBA,IAAAA,CAAC,CAACC,cAAF;AACA,QAAIvC,KAAK,GAAGF,IAAI,CAACE,KAAjB;;AACA,YAAQsC,CAAC,CAACE,MAAF,CAASpC,IAAjB;AACI,WAAK,OAAL;AACI,YAAIqC,QAAQ,GAAG,IAAIC,IAAJ,GAAWC,WAAX,EAAf;AACA,YAAIC,IAAI,GAAG,IAAIF,IAAJ,CAASD,QAAQ,GAAG,CAAX,GAAeH,CAAC,CAACE,MAAF,CAASK,KAAjC,EAAwC,CAAxC,EAA2C,CAA3C,CAAX;AACAjB,QAAAA,OAAO,CAACgB,IAAD,CAAP;AACA;;AACJ,WAAK,SAAL;AACI5C,QAAAA,KAAK,GAAGV,aAAa,GAAGwD,SAAhB,CAA0BR,CAAC,CAACE,MAAF,CAASK,KAAnC,EAA0CE,QAA1C,GAAqDC,WAArD,EAAR;AACA;;AACJ,WAAK,OAAL;AACIhD,QAAAA,KAAK,GAAGsC,CAAC,CAACE,MAAF,CAASK,KAAT,CAAeE,QAAf,GAA0BC,WAA1B,EAAR;AACA;AAXR;;AAaAjD,IAAAA,OAAO,CAAC,EAAC,GAAGD,IAAJ;AAAU,OAACwC,CAAC,CAACE,MAAF,CAASpC,IAAV,GAAiBkC,CAAC,CAACE,MAAF,CAASK,KAApC;AAA2C7C,MAAAA,KAAK,EAAEA,KAAlD;AAAyDQ,MAAAA,QAAQ,EAAEmB;AAAnE,KAAD,CAAP;AACH,GAjBD;;AAoBA,QAAMsB,WAAW,GAAG,MAAOX,CAAP,IAAa;AAC7BA,IAAAA,CAAC,CAACC,cAAF;;AACA,QAAI;AACA,UAAI,EAAEzC,IAAI,CAACM,IAAL,IAAaN,IAAI,CAACO,OAAlB,IAA6BP,IAAI,CAACQ,KAAlC,IAA2CR,IAAI,CAACS,MAAhD,IAA0DT,IAAI,CAACU,QAA/D,IAA2EV,IAAI,CAACE,KAAhF,IAAyFF,IAAI,CAACG,QAAhG,CAAJ,EACIT,MAAM,CAAC,uBAAD,CAAN;AAEJ,UAAIY,IAAI,GAAG,EAAX;AAAA,UAAeC,OAAO,GAAG,EAAzB;AAAA,UAA6BL,KAAK,GAAG,EAArC;AAAA,UAAyCC,QAAQ,GAAG,EAApD;;AACA,UAAIH,IAAI,CAACM,IAAL,IAAa,CAAClB,OAAO,CAACgE,eAAR,CAAwBC,IAAxB,CAA6BrD,IAAI,CAACM,IAAlC,CAAlB,EAA2D;AACvDA,QAAAA,IAAI,GAAG,+BAAP;AACA,cAAMX,SAAS,CAAC,IAAD,EAAM,MAAN,EAAc,kBAAd,CAAf;AACH;;AACD,UAAIK,IAAI,CAACO,OAAL,IAAgB,CAACnB,OAAO,CAACgE,eAAR,CAAwBC,IAAxB,CAA6BrD,IAAI,CAACO,OAAlC,CAArB,EAAiE;AAC7DA,QAAAA,OAAO,GAAG,+BAAV;AACA,cAAMZ,SAAS,CAAC,IAAD,EAAM,SAAN,EAAiB,qBAAjB,CAAf;AACH;;AACD,UAAIK,IAAI,CAACE,KAAL,IAAc,CAACd,OAAO,CAACkE,WAAR,CAAoBD,IAApB,CAAyBrD,IAAI,CAACE,KAA9B,CAAnB,EAAyD;AACrDA,QAAAA,KAAK,GAAG,6CAAR;AACA,cAAMP,SAAS,CAAC,IAAD,EAAM,OAAN,EAAe,mBAAf,CAAf;AACH;;AAED,UAAIK,IAAI,CAACG,QAAL,IAAiB,CAACf,OAAO,CAACmE,cAAR,CAAuBF,IAAvB,CAA4BrD,IAAI,CAACG,QAAjC,CAAtB,EAAkE;AAC9D,YAAIH,IAAI,CAACG,QAAL,CAAcqD,MAAd,GAAuB,CAAvB,IAA4BxD,IAAI,CAACG,QAAL,CAAcqD,MAAd,GAAuB,EAAvD,EACIrD,QAAQ,GAAG,6CAAX,CADJ,KAGIA,QAAQ,GAAG,6CAAX;AACJ,cAAMR,SAAS,CAAC,IAAD,EAAO,UAAP,EAAmB,sBAAnB,CAAf;AACH;;AAED,OAACW,IAAD,KAAS,MAAMX,SAAS,CAAC,KAAD,EAAO,MAAP,EAAe,kBAAf,CAAxB;AACA,OAACY,OAAD,KAAY,MAAMZ,SAAS,CAAC,KAAD,EAAO,SAAP,EAAkB,qBAAlB,CAA3B;AACA,OAACO,KAAD,KAAU,MAAMP,SAAS,CAAC,KAAD,EAAO,OAAP,EAAgB,mBAAhB,CAAzB;AACA,OAACQ,QAAD,KAAa,MAAMR,SAAS,CAAC,KAAD,EAAO,UAAP,EAAmB,sBAAnB,CAA5B;AAEAiB,MAAAA,SAAS,CAAC;AAACN,QAAAA,IAAD;AAAOC,QAAAA,OAAP;AAAgBL,QAAAA,KAAhB;AAAuBC,QAAAA;AAAvB,OAAD,CAAT;AACA,UAAI,CAACG,IAAD,IAAS,CAACC,OAAV,IAAqB,CAACL,KAAtB,IAA+B,CAACC,QAApC,EACI,OAAO,IAAP,CADJ,KAGI,OAAO,KAAP;AAEP,KArCD,CAsCA,OAAOqC,CAAP,EAAU,CAAE;AACf,GAzCD;;AA2CA,QAAMiB,WAAW,GAAG/C,QAAQ,IAAI;AAC5BoB,IAAAA,OAAO,CAACpB,QAAD,CAAP;AACAT,IAAAA,OAAO,CAAC,EAAC,GAAGD,IAAJ;AAAUU,MAAAA,QAAQ,EAAEA;AAApB,KAAD,CAAP;AACH,GAHD;;AAKA,QAAMgD,eAAe,GAAG,MAAOlB,CAAP,IAAa;AACjCA,IAAAA,CAAC,CAACC,cAAF;;AACA,QAAI;AACA,UAAI,MAAMU,WAAW,CAACX,CAAD,CAArB,EAAyB;AACrB,cAAMmB,IAAI,GAAG,MAAM5D,OAAO,CAAC,sBAAD,EAAyB,MAAzB,EAAiC,EAAC,GAAGC;AAAJ,SAAjC,CAA1B;AACA4D,QAAAA,OAAO,CAACC,GAAR,CAAYF,IAAI,CAACG,OAAjB;;AACA,YAAIH,IAAI,CAACG,OAAL,KAAiB,kBAArB,EAAwC;AACpCpE,UAAAA,MAAM,CAAC,qBAAD,CAAN;AACAO,UAAAA,OAAO,CAAC;AACJC,YAAAA,KAAK,EAAE,EADH;AAEJC,YAAAA,QAAQ,EAAE,EAFN;AAGJC,YAAAA,IAAI,EAAE,GAHF;AAIJC,YAAAA,GAAG,EAAE,CAAC,MAAD,CAJD;AAKJC,YAAAA,IAAI,EAAE,EALF;AAMJC,YAAAA,OAAO,EAAE,EANL;AAOJC,YAAAA,KAAK,EAAE,EAPH;AAQJC,YAAAA,MAAM,EAAE,EARJ;AASJC,YAAAA,QAAQ,EAAE;AATN,WAAD,CAAP;AAWH,SAbD,MAcK,IAAIiD,IAAI,CAACG,OAAL,KAAiB,0BAArB,EAAgD;AACjDpE,UAAAA,MAAM,CAAC,6CAAD,CAAN;AACH;AACJ;AACJ,KAtBD,CAuBA,OAAO8C,CAAP,EAAU,CAAE;AACf,GA1BD;;AA4BA,QAAMuB,WAAW,GAAGnF,WAAW,CAAC,YAAY;AACxC,QAAI;AACA,YAAMoF,OAAO,GAAG,MAAMjE,OAAO,CAAC,eAAD,EAAkB,KAAlB,EAAyB,IAAzB,EAA+B;AACxDkE,QAAAA,aAAa,EAAG,UAASlC,KAAM;AADyB,OAA/B,CAA7B;AAGAiC,MAAAA,OAAO,CAACE,IAAR,CAAa,CAACC,CAAD,EAAIC,CAAJ,KAAUD,CAAC,CAAC3D,KAAF,GAAU4D,CAAC,CAAC5D,KAAZ,GAAoB,CAApB,GAAwB,CAAC,CAAhD;AACAM,MAAAA,SAAS,CAACkD,OAAD,CAAT;AAEH,KAPD,CAOE,OAAOxB,CAAP,EAAU,CAAE;AACjB,GAT8B,EAS5B,CAACT,KAAD,EAAQhC,OAAR,CAT4B,CAA/B;;AAWA,QAAMsE,sBAAsB,GAAG7B,CAAC,IAAI;AAChCA,IAAAA,CAAC,CAACC,cAAF;;AACA,YAAQlB,WAAR;AACI,WAAK,QAAL;AACIC,QAAAA,iBAAiB,CAAC,UAAD,CAAjB;AACA;;AACJ,WAAK,MAAL;AACA,WAAK,UAAL;AACIA,QAAAA,iBAAiB,CAAC,QAAD,CAAjB;AACA8C,QAAAA,QAAQ,CAACC,cAAT,CAAwB,QAAxB,EAAkCC,KAAlC;AACA;AARR;AAUH,GAZD;;AAcA,QAAMC,QAAQ,GAAGjC,CAAC,IAAI;AAClBA,IAAAA,CAAC,CAACC,cAAF;;AACA,QAAI;AACA,UAAIiC,YAAY,GAAGlC,CAAC,CAACE,MAAF,CAASK,KAAT,CAAeE,QAAf,GAA0BC,WAA1B,EAAnB;AACAhC,MAAAA,SAAS,CAACwD,YAAD,CAAT;AACAtD,MAAAA,WAAW,CAAC,KAAD,CAAX;;AACA,UAAIsD,YAAY,IAAI,EAApB,EAAwB;AACpB,YAAIC,WAAW,GAAG,EAAlB;AACA9D,QAAAA,MAAM,CAAC+D,GAAP,CAAWpE,KAAK,IAAI;AAChB,cAAIqE,aAAa,GAAG,EAApB;AACArE,UAAAA,KAAK,CAACsE,QAAN,CAAeF,GAAf,CAAmBG,OAAO,IAAI;AAC1BF,YAAAA,aAAa,CAACG,IAAd,CAAmB,CAACD,OAAO,CAACzE,IAAR,GAAeyE,OAAO,CAACxE,OAAxB,EAAiC0C,QAAjC,GAA4CC,WAA5C,EAAnB;AACH,WAFD;AAGAyB,UAAAA,WAAW,CAACK,IAAZ,CAAiB,CAACxE,KAAK,CAACA,KAAN,GAAcA,KAAK,CAACC,MAApB,GAA6BoE,aAA9B,EAA6C5B,QAA7C,GAAwDC,WAAxD,EAAjB;AACH,SAND;AAQA,YAAI+B,OAAO,GAAG,EAAd;AACAN,QAAAA,WAAW,CAACC,GAAZ,CAAgB,CAACpE,KAAD,EAAQ4B,CAAR,KAAc;AAC1B,cAAI5B,KAAK,CAACyC,QAAN,GAAiBiC,QAAjB,CAA0BR,YAA1B,CAAJ,EACIO,OAAO,CAACD,IAAR,CAAa5C,CAAb;AACP,SAHD;;AAKA,YAAI6C,OAAO,CAACzB,MAAR,IAAkB,CAAtB,EAAwB;AACpBxC,UAAAA,cAAc,CAAC,CAAC,GAAGiE,OAAJ,CAAD,CAAd;AACA7D,UAAAA,WAAW,CAAC,KAAD,CAAX;AACH,SAHD,MAIKA,WAAW,CAAC,IAAD,CAAX;AACR,OArBD,MAsBK+D,OAAO;AACf,KA3BD,CA4BA,OAAO3C,CAAP,EAAU,CAAE;AACf,GA/BD;;AAiCA,QAAM4C,MAAM,GAAG5C,CAAC,IAAI;AAChBA,IAAAA,CAAC,CAACC,cAAF;;AACA,QAAI;AACA,cAAQpB,MAAR;AACI,aAAK,IAAL;AACIiD,UAAAA,QAAQ,CAACC,cAAT,CAAwB,UAAxB,EAAoCc,KAApC,GAA4C,4BAA5C;AACAf,UAAAA,QAAQ,CAACC,cAAT,CAAwB,kBAAxB,EAA4Cc,KAA5C,GAAoD,yBAApD;AACA/D,UAAAA,SAAS,CAAC,KAAD,CAAT;AACA;;AACJ,aAAK,KAAL;AACIgD,UAAAA,QAAQ,CAACC,cAAT,CAAwB,UAAxB,EAAoCc,KAApC,GAA4C,4BAA5C;AACAf,UAAAA,QAAQ,CAACC,cAAT,CAAwB,kBAAxB,EAA4Cc,KAA5C,GAAoD,iCAApD;AACA/D,UAAAA,SAAS,CAAC,IAAD,CAAT;AACA;AAVR;AAYH,KAbD,CAcA,OAAOkB,CAAP,EAAU,CAAE;AACf,GAjBD;;AAmBA,QAAM8C,mBAAmB,GAAG9C,CAAC,IAAI;AAC7BA,IAAAA,CAAC,CAACC,cAAF;;AACA,YAAQhB,QAAR;AACI,WAAK,QAAL;AACIC,QAAAA,cAAc,CAAC,UAAD,CAAd;AACA4C,QAAAA,QAAQ,CAACC,cAAT,CAAwB,OAAxB,EAAiCgB,SAAjC,GAA6C,sBAA7C;AACAjB,QAAAA,QAAQ,CAACC,cAAT,CAAwB,kBAAxB,EAA4CgB,SAA5C,GAAwD,uCAAxD;AACAjB,QAAAA,QAAQ,CAACC,cAAT,CAAwB,eAAxB,EAAyCgB,SAAzC,GAAqD,kCAArD;AACA;;AACJ,WAAK,MAAL;AACA,WAAK,UAAL;AACI7D,QAAAA,cAAc,CAAC,QAAD,CAAd;AACA4C,QAAAA,QAAQ,CAACC,cAAT,CAAwB,OAAxB,EAAiCgB,SAAjC,GAA6C,yBAA7C;AACAjB,QAAAA,QAAQ,CAACC,cAAT,CAAwB,kBAAxB,EAA4CgB,SAA5C,GAAwD,0CAAxD;AACAjB,QAAAA,QAAQ,CAACC,cAAT,CAAwB,eAAxB,EAAyCgB,SAAzC,GAAqD,+BAArD;AACA;AAbR;AAeH,GAjBD;;AAmBA,QAAMC,2BAA2B,GAAGhD,CAAC,IAAI;AACrCA,IAAAA,CAAC,CAACC,cAAF;AACAb,IAAAA,qBAAqB,CAAC,CAACD,eAAF,CAArB;AACH,GAHD;;AAKA,QAAM8D,UAAU,GAAGjD,CAAC,IAAI;AACpBA,IAAAA,CAAC,CAACC,cAAF;AACAxC,IAAAA,OAAO,CAAC,EAAC,GAAGD,IAAJ;AAAUK,MAAAA,GAAG,EAAEnB,MAAM,CAACsD,CAAC,CAACE,MAAF,CAASgD,EAAT,CAAYC,KAAZ,CAAkB,CAAlB,CAAD;AAArB,KAAD,CAAP;AACH,GAHD;;AAKA,QAAMR,OAAO,GAAG,MAAM;AAClB,QAAIS,SAAS,GAAG,EAAhB;;AACA,SAAK,IAAIxD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGvB,MAAM,CAAC2C,MAA3B,EAAmCpB,CAAC,EAApC,EAAuC;AACnCwD,MAAAA,SAAS,CAACZ,IAAV,CAAe5C,CAAf;AACH;;AACDpB,IAAAA,cAAc,CAAC,CAAC,GAAG4E,SAAJ,CAAD,CAAd;AACH,GAND;;AAQA,QAAMC,WAAW,GAAG,OAAOrD,CAAP,EAAUsD,CAAV,KAAgB;AAChCtD,IAAAA,CAAC,CAACC,cAAF;;AACA,QAAI;AACA,YAAMkB,IAAI,GAAG,MAAM5D,OAAO,CAAE,uBAAsB+F,CAAE,EAA1B,EAA6B,KAA7B,EAAoC,IAApC,EAA0C;AAChE7B,QAAAA,aAAa,EAAG,UAASlC,KAAM;AADiC,OAA1C,CAA1B;;AAGA,UAAI4B,IAAI,CAACG,OAAL,KAAiB,oBAArB,EAA0C;AACtC,YAAIgC,CAAC,IAAI,CAAT,EACIpG,MAAM,CAAC,6BAAD,CAAN,CADJ,KAEK,IAAIoG,CAAC,IAAI,CAAC,CAAV,EACDpG,MAAM,CAAC,6BAAD,CAAN;AACJqE,QAAAA,WAAW,CAACvB,CAAD,CAAX;AACH;AACJ,KAXD,CAYA,OAAOA,CAAP,EAAU,CAAE;AACf,GAfD;;AAiBA1D,EAAAA,SAAS,CAAC,MAAM;AAEZ,QAAI+B,MAAM,CAAC2C,MAAP,IAAiB,CAArB,EAAwBO,WAAW;AACnCO,IAAAA,QAAQ,CAACyB,IAAT,CAAcV,KAAd,GAAsB,uFAAtB;AACAf,IAAAA,QAAQ,CAAC0B,KAAT,GAAiB,SAAjB;AAEA,QAAIjF,WAAW,CAACyC,MAAZ,IAAsB,CAA1B,EACI2B,OAAO;AAEd,GATQ,EASN,CAACpB,WAAD,EAAchD,WAAd,EAA2BoE,OAA3B,CATM,CAAT;AAcA,sBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAI,IAAA,EAAE,EAAG,OAAT;AAAiB,IAAA,SAAS,EAAG,gBAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kDADJ,eAEI;AAAK,IAAA,SAAS,EAAG,kBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAO,IAAA,IAAI,EAAG,MAAd;AAAqB,IAAA,EAAE,EAAG,QAA1B;AACO,IAAA,SAAS,EAAM5D,WAAW,KAAK,QAAhB,IAA4B,iBAA5B,IACfA,WAAW,KAAK,UAAhB,IAA8B,oBADf,IAEfA,WAAW,KAAK,MAAhB,IAA0B,WAHjC;AAIO,IAAA,WAAW,EAAG,gJAJrB;AAIkD,IAAA,QAAQ,EAAIiB,CAAC,IAAIiC,QAAQ,CAACjC,CAAD,CAJ3E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAOM5C,UAAU,CAAC;AAAE2B,IAAAA,WAAF;AAAe8C,IAAAA;AAAf,GAAD,CAPhB,eASI;AAAK,IAAA,SAAS,EAAG,UAAjB;AAA4B,IAAA,EAAE,EAAG,UAAjC;AAA4C,IAAA,OAAO,EAAI7B,CAAC,IAAI4C,MAAM,CAAC5C,CAAD,CAAlE;AAAuE,IAAA,KAAK,EAAC,OAA7E;AAAqF,IAAA,MAAM,EAAC,OAA5F;AAAoG,IAAA,OAAO,EAAC,aAA5G;AAA0H,IAAA,OAAO,EAAC,KAAlI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAG,IAAA,EAAE,EAAC,MAAN;AAAa,IAAA,MAAM,EAAC,MAApB;AAA2B,oBAAa,GAAxC;AAA4C,IAAA,IAAI,EAAC,MAAjD;AAAwD,iBAAU,SAAlE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAM,IAAA,CAAC,EAAC,qgCAAR;AAA8gC,IAAA,EAAE,EAAC,gBAAjhC;AACM,IAAA,MAAM,EAAC,SADb;AACuB,IAAA,IAAI,EAAC,SAD5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,eAGI;AAAM,IAAA,CAAC,EAAC,m/BAAR;AAA4/B,IAAA,EAAE,EAAC,wBAA//B;AACM,IAAA,MAAM,EAAC,SADb;AACuB,IAAA,IAAI,EAAC,SAD5B;AACsC,IAAA,SAAS,EAAC,2FADhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHJ,CADJ,CATJ,CAFJ,EA8CSrB,QAAQ,iBAAI;AAAI,IAAA,SAAS,EAAG,UAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oGA9CrB,eAgDI;AAAK,IAAA,EAAE,EAAG,kBAAV;AAA6B,IAAA,SAAS,EAAG,kBAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEQ,CAACA,QAAD,IAAaN,MAAb,IACAA,MAAM,CAAC+D,GAAP,CAAW,CAACpE,KAAD,EAAQyF,KAAR,KACP;AACI,QAAIlF,WAAW,CAACmE,QAAZ,CAAqBe,KAArB,CAAJ,EACA,oBACI;AAAK,MAAA,SAAS,EAAG,2BAAjB;AAA6C,MAAA,GAAG,EAAIA,KAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAG,MAAA,SAAS,EAAG,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAwBzF,KAAK,CAACA,KAA9B,EAAqCA,KAAK,CAACC,MAA3C,CADJ,eAEI;AAAK,MAAA,SAAS,EAAG,UAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEID,KAAK,CAACsE,QAAN,CAAeF,GAAf,CAAmB,CAACG,OAAD,EAAU3C,CAAV,KAAgB;AAC/B,UAAI,KAAKiB,IAAL,CAAUpC,MAAV,KAAqB,CAAC8D,OAAO,CAACzE,IAAR,GAAeyE,OAAO,CAACxE,OAAxB,EAAiC0C,QAAjC,GAA4CC,WAA5C,GAA0DgC,QAA1D,CAAmEjE,MAAnE,CAAzB,EACI,oBACI,oBAAC,OAAD;AAAS,QAAA,EAAE,EAAI,cAAc8D,OAAO,CAACmB,QAArC;AAA+C,QAAA,GAAG,EAAI9D,CAAtD;AAAyD,QAAA,SAAS,EAAG,4BAArE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAK,QAAA,SAAS,EAAG,gBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAI2C,OAAO,CAACzE,IAAZ,OAAmByE,OAAO,CAACxE,OAA3B,CADJ,CADJ,eAII;AAAG,QAAA,SAAS,EAAG,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAsBpB,aAAa,CAAC4F,OAAO,CAAC1E,GAAT,CAAnC,CAJJ,CADJ;AAQP,KAVD,CAFJ,CAFJ,CADJ;AAoBH,GAvBL,CAHR,CAhDJ,eA6EI;AAAK,IAAA,SAAS,EAAG,eAAjB;AAAiC,IAAA,EAAE,EAAG,eAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAEI;AAAK,IAAA,SAAS,EAAG,oBAAjB;AAAsC,IAAA,OAAO,EAAKmC,CAAC,IAAIgD,2BAA2B,CAAChD,CAAD,CAAlF;AAAwF,IAAA,QAAQ,EAAE1C,OAAlG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACKX,aAAa,CAACa,IAAI,CAACK,GAAN,CADlB,CAFJ,EAOQsB,eAAe,iBACf;AAAK,IAAA,SAAS,EAAG,gBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEQzC,MAAM,CAAC0F,GAAP,CAAW,CAACuB,KAAD,EAAQ/D,CAAR,KAAc;AACrB,wBACI;AAAK,MAAA,SAAS,EAAG,oBAAjB;AAAsC,MAAA,OAAO,EAAII,CAAC,IAAIiD,UAAU,CAACjD,CAAD,CAAhE;AAAqE,MAAA,GAAG,EAAIJ,CAA5E;AAA+E,MAAA,EAAE,EAAI,MAAMA,CAA3F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACKjD,aAAa,CAACgH,KAAD,CADlB,CADJ;AAKH,GAND,CAFR,CARR,EAsBK,CAACxE,eAAD,iBACD;AAAK,IAAA,SAAS,EAAG,yBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACA;AAAO,IAAA,IAAI,EAAC,MAAZ;AAAmB,IAAA,EAAE,EAAC,MAAtB;AAA6B,IAAA,IAAI,EAAC,MAAlC;AAAyC,IAAA,WAAW,EAAC,oBAArD;AAA2D,IAAA,QAAQ,EAAEa,CAAC,IAAID,aAAa,CAACC,CAAD,CAAvF;AACO,IAAA,KAAK,EAAExC,IAAI,CAACM,IADnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADA,eAGI;AAAG,IAAA,SAAS,EAAG,OAAf;AAAuB,IAAA,EAAE,EAAG,kBAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAgDK,MAAM,CAACL,IAAvD,CAHJ,eAII;AAAO,IAAA,IAAI,EAAC,MAAZ;AAAmB,IAAA,EAAE,EAAG,SAAxB;AAAkC,IAAA,IAAI,EAAC,SAAvC;AAAiD,IAAA,WAAW,EAAC,4CAA7D;AAAuE,IAAA,QAAQ,EAAEkC,CAAC,IAAID,aAAa,CAACC,CAAD,CAAnG;AAAwG,IAAA,KAAK,EAAIxC,IAAI,CAACO,OAAtH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJJ,eAKI;AAAG,IAAA,SAAS,EAAG,OAAf;AAAuB,IAAA,EAAE,EAAG,qBAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAmDI,MAAM,CAACJ,OAA1D,CALJ,eAOI;AAAK,IAAA,SAAS,EAAG,gBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACA;AAAQ,IAAA,IAAI,EAAC,OAAb;AAAqB,IAAA,YAAY,EAAG,EAApC;AAAuC,IAAA,QAAQ,EAAEiC,CAAC,IAAID,aAAa,CAACC,CAAD,CAAnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACA;AAAQ,IAAA,KAAK,EAAG,EAAhB;AAAmB,IAAA,QAAQ,MAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCADA,eAEA;AAAQ,IAAA,KAAK,EAAG,GAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAFA,eAGA;AAAQ,IAAA,KAAK,EAAG,GAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAHA,eAIA;AAAQ,IAAA,KAAK,EAAG,GAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAJA,eAKA;AAAQ,IAAA,KAAK,EAAG,GAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SALA,eAMA;AAAQ,IAAA,KAAK,EAAG,GAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SANA,eAOA;AAAQ,IAAA,KAAK,EAAG,GAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAPA,eAQA;AAAQ,IAAA,KAAK,EAAG,GAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SARA,eASA;AAAQ,IAAA,KAAK,EAAG,GAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SATA,eAUA;AAAQ,IAAA,KAAK,EAAG,GAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAVA,eAWA;AAAQ,IAAA,KAAK,EAAG,IAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAXA,eAYA;AAAQ,IAAA,KAAK,EAAG,IAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAZA,CADA,eAeA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAfA,eAgBA;AAAQ,IAAA,EAAE,EAAG,QAAb;AAAsB,IAAA,IAAI,EAAC,QAA3B;AAAoC,IAAA,YAAY,EAAG,EAAnD;AAAsD,IAAA,QAAQ,EAAEA,CAAC,IAAID,aAAa,CAACC,CAAD,CAAlF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACA;AAAQ,IAAA,KAAK,EAAG,EAAhB;AAAmB,IAAA,QAAQ,MAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCADA,eAEA;AAAQ,IAAA,KAAK,EAAG,QAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAFA,eAGA;AAAQ,IAAA,KAAK,EAAG,QAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAHA,eAIA;AAAQ,IAAA,KAAK,EAAG,QAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAJA,eAKA;AAAQ,IAAA,KAAK,EAAG,QAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cALA,eAMA;AAAQ,IAAA,KAAK,EAAG,QAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cANA,CAhBA,CAPJ,eAiCI,oBAAC,UAAD;AAAY,IAAA,QAAQ,EAAIX,IAAxB;AACY,IAAA,KAAK,EAAIpC,cAAc,CAACoC,IAAD,CADnC;AAEA,IAAA,QAAQ,EAAIA,IAAI,IAAI4B,WAAW,CAAC5B,IAAD,CAF/B;AAGA,IAAA,eAAe,EAAG,2EAHlB;AAIA,IAAA,MAAM,EAAG,IAJT;AAIc,IAAA,UAAU,EAAC,YAJzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAjCJ,eAuCI;AAAO,IAAA,IAAI,EAAC,MAAZ;AAAmB,IAAA,EAAE,EAAG,OAAxB;AAAgC,IAAA,IAAI,EAAC,OAArC;AAA6C,IAAA,WAAW,EAAC,gCAAzD;AAAiE,IAAA,QAAQ,EAAEW,CAAC,IAAID,aAAa,CAACC,CAAD,CAA7F;AAAkG,IAAA,KAAK,EAAIxC,IAAI,CAACE,KAAhH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAvCJ,eAwCI;AAAG,IAAA,SAAS,EAAG,OAAf;AAAuB,IAAA,EAAE,EAAG,mBAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAiDS,MAAM,CAACT,KAAxD,CAxCJ,eAyCI;AAAO,IAAA,IAAI,EAAC,MAAZ;AAAmB,IAAA,EAAE,EAAG,UAAxB;AAAmC,IAAA,IAAI,EAAC,UAAxC;AAAmD,IAAA,WAAW,EAAC,sCAA/D;AAAwE,IAAA,QAAQ,EAAEsC,CAAC,IAAID,aAAa,CAACC,CAAD,CAApG;AAAyG,IAAA,KAAK,EAAIxC,IAAI,CAACG,QAAvH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAzCJ,eA0CI;AAAG,IAAA,SAAS,EAAG,OAAf;AAAuB,IAAA,EAAE,EAAG,sBAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAoDQ,MAAM,CAACR,QAA3D,CA1CJ,eA4CI;AAAK,IAAA,SAAS,EAAG,cAAjB;AAAgC,IAAA,OAAO,EAAIqC,CAAC,IAAIkB,eAAe,CAAClB,CAAD,CAA/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kDADJ,CA5CJ,CAvBJ,CA7EJ,EAwJQ,CAACrB,QAAD,IAAaN,MAAb,iBACA;AAAK,IAAA,SAAS,EAAG,2BAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAK,IAAA,SAAS,EAAG,aAAjB;AAA+B,IAAA,OAAO,EAAI2B,CAAC,IAAIqD,WAAW,CAACrD,CAAD,EAAI,CAAC,CAAL,CAA1D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uFADJ,CADJ,eAII;AAAK,IAAA,SAAS,EAAG,cAAjB;AAAgC,IAAA,OAAO,EAAIA,CAAC,IAAIqD,WAAW,CAACrD,CAAD,EAAI,CAAJ,CAA3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uFADJ,CAJJ,CAzJR,CADJ;AAsKH,CAncM;AAqcP,eAAe3C,QAAf","sourcesContent":["import React, {useCallback, useContext, useEffect, useState} from 'react';\nimport './Appearence/index.css'\nimport './Appearence/Auth.css'\nimport './Appearence/Students.css';\nimport './Appearence/DatePicker.css';\nimport {useHttp} from \"../Hooks/Http.hook\";\nimport {AuthContext} from \"./Context/AuthContext\";\nimport {emojis, emojiToString} from \"./Functions and const/Emoji\";\nimport RegExps from \"./Functions and const/RegExps\";\nimport {NavLink} from \"react-router-dom\";\nimport DatePicker from \"react-datepicker/es\";\nimport {registerLocale} from \"react-datepicker\";\nimport * as cyrToTranslit from 'cyrillic-to-translit-js'\nimport formatDateToRu from \"./Functions and const/DateFormat\";\nimport notify from './Functions and const/Notify'\nimport showError from './Functions and const/ShowError'\nimport SearchIcon from \"./Appearence/Images/SearchIcon\";\n\n\nexport const Students = () => {\n\n    const {loading, request} = useHttp();\n\n    const [form, setForm] = useState({\n        login: '',\n        password: '',\n        type: 's',\n        pic: [128522],\n        name: '',\n        surname: '',\n        grade: '',\n        letter: '',\n        birthday: ''\n    })\n    const [errors, setErrors] = useState({\n        name: '',\n        surname: '',\n        login: '',\n        password: ''\n    })\n    const [grades, setGrades] = useState([])\n    const [shownGrades, setShownGrades] = useState([])\n    const [search, setSearch] = useState([])\n    const [notFound, setNotFound] = useState()\n    const [sorted, setSorted] = useState(false)\n    const [isSearching, activateSearching] = useState('none')\n    const [isAdding, activateAdding] = useState('none')\n    const [isChoosingEmoji, activateChoosingEmoji] = useState(false)\n    const [date, setDate] = useState()\n    const {token} = useContext(AuthContext)\n\n\n    const months = ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь']\n    const days = ['вс', 'пн', 'вт', 'ср', 'чт', 'пт', 'сб']\n\n    registerLocale('ru', {\n        localize: {\n            month: i => months[i],\n            day: i => days[i]\n        },\n        formatLong:{}\n    });\n\n    const changeHandler = e => {\n        e.preventDefault()\n        let login = form.login\n        switch (e.target.name) {\n            case 'grade':\n                let thisYear = new Date().getFullYear();\n                let then = new Date(thisYear - 7 - e.target.value, 0, 1);\n                setDate(then);\n                break\n            case 'surname':\n                login = cyrToTranslit().transform(e.target.value).toString().toLowerCase();\n                break;\n            case 'login':\n                login = e.target.value.toString().toLowerCase();\n                break;\n        }\n        setForm({...form, [e.target.name]: e.target.value, login: login, birthday: date})\n    }\n\n\n    const checkFields = async (e) => {\n        e.preventDefault()\n        try {\n            if (!(form.name && form.surname && form.grade && form.letter && form.birthday && form.login && form.password))\n                notify(\"Не все поля заполнены\")\n\n            let name = '', surname = '', login = '', password = ''\n            if (form.name && !RegExps.cyrillicsRegExp.test(form.name)) {\n                name = 'Допустима только из кириллица'\n                await showError(true,'name', 'errorStudentName')\n            }\n            if (form.surname && !RegExps.cyrillicsRegExp.test(form.surname)) {\n                surname = 'Допустима только из кириллица'\n                await showError(true,'surname', 'errorStudentSurname')\n            }\n            if (form.login && !RegExps.loginRegExp.test(form.login)) {\n                login = 'Допустимы только a-z, цифры, точка и пробел'\n                await showError(true,'login', 'errorStudentLogin')\n            }\n\n            if (form.password && !RegExps.passwordRegExp.test(form.password)) {\n                if (form.password.length < 6 || form.password.length > 20)\n                    password = 'Пароль должен содержать от 6 до 20 символов'\n                else\n                    password = 'Допустимы только A-z, цифры, точка и пробел'\n                await showError(true, 'password', 'errorStudentPassword')\n            }\n\n            !name && await showError(false,'name', 'errorStudentName')\n            !surname && await showError(false,'surname', 'errorStudentSurname')\n            !login && await showError(false,'login', 'errorStudentLogin')\n            !password && await showError(false,'password', 'errorStudentPassword')\n\n            setErrors({name, surname, login, password})\n            if (!name && !surname && !login && !password)\n                return true\n            else\n                return false\n\n        }\n        catch (e) {}\n    }\n\n    const setBirthday = birthday => {\n        setDate(birthday)\n        setForm({...form, birthday: birthday})\n    }\n\n    const registerHandler = async (e) => {\n        e.preventDefault()\n        try {\n            if (await checkFields(e)){\n                const data = await request('/api/students/create', 'POST', {...form})\n                console.log(data.message)\n                if (data.message === 'User\\'ve created'){\n                    notify('Пользователь создан')\n                    setForm({\n                        login: '',\n                        password: '',\n                        type: 's',\n                        pic: [128522],\n                        name: '',\n                        surname: '',\n                        grade: '',\n                        letter: '',\n                        birthday: ''\n                    })\n                }\n                else if (data.message === 'This user already exists'){\n                    notify('Пользователь с таким логином уже существует')\n                }\n            }\n        }\n        catch (e) {}\n    }\n\n    const fetchGrades = useCallback(async () => {\n        try {\n            const fetched = await request('/api/students', 'GET', null, {\n                Authorization: `Bearer ${token}`\n            })\n            fetched.sort((a, b) => a.grade > b.grade ? 1 : -1);\n            setGrades(fetched)\n\n        } catch (e) {}\n    }, [token, request])\n\n    const handleSearchActivating = e => {\n        e.preventDefault()\n        switch (isSearching){\n            case 'active':\n                activateSearching('inactive');\n                break\n            case 'none':\n            case 'inactive':\n                activateSearching('active');\n                document.getElementById('search').focus()\n                break\n        }\n    }\n\n    const doSearch = e => {\n        e.preventDefault()\n        try {\n            let searchFilter = e.target.value.toString().toLowerCase()\n            setSearch(searchFilter)\n            setNotFound(false)\n            if (searchFilter != '') {\n                let gradesArray = []\n                grades.map(grade => {\n                    let studentsArray = []\n                    grade.students.map(student => {\n                        studentsArray.push((student.name + student.surname).toString().toLowerCase())\n                    })\n                    gradesArray.push((grade.grade + grade.letter + studentsArray).toString().toLowerCase())\n                })\n\n                let indexes = []\n                gradesArray.map((grade, i) => {\n                    if (grade.toString().includes(searchFilter))\n                        indexes.push(i)\n                })\n\n                if (indexes.length != 0){\n                    setShownGrades([...indexes])\n                    setNotFound(false)\n                }\n                else setNotFound(true)\n            }\n            else showAll()\n        }\n        catch (e) {}\n    }\n\n    const doSort = e => {\n        e.preventDefault()\n        try {\n            switch (sorted) {\n                case true:\n                    document.getElementById('sortIcon').style = 'transform: rotate(360deg);';\n                    document.getElementById('gradesCollection').style = 'flex-direction: column;';\n                    setSorted(false);\n                    break;\n                case false:\n                    document.getElementById('sortIcon').style = 'transform: rotate(180deg);';\n                    document.getElementById('gradesCollection').style = 'flex-direction: column-reverse;';\n                    setSorted(true);\n                    break;\n            }\n        }\n        catch (e) {}\n    }\n\n    const handleAddActivating = e => {\n        e.preventDefault()\n        switch (isAdding){\n            case 'active':\n                activateAdding('inactive');\n                document.getElementById('label').className = 'addingPanelAppearing'\n                document.getElementById('gradesCollection').className = 'addingPanelAppearing gradesCollection'\n                document.getElementById('addingStudent').className = 'gradesDisappearing addingStudent'\n                break\n            case 'none':\n            case 'inactive':\n                activateAdding('active');\n                document.getElementById('label').className = 'addingPanelDisappearing'\n                document.getElementById('gradesCollection').className = 'addingPanelDisappearing gradesCollection'\n                document.getElementById('addingStudent').className = 'gradesAppearing addingStudent'\n                break\n        }\n    }\n\n    const handleChooseEmojiActivating = e => {\n        e.preventDefault()\n        activateChoosingEmoji(!isChoosingEmoji)\n    }\n\n    const setFormPic = e => {\n        e.preventDefault()\n        setForm({...form, pic: emojis[e.target.id.slice(1)]})\n    }\n\n    const showAll = () => {\n        let shownSize = []\n        for (let i = 0; i < grades.length; i++){\n            shownSize.push(i)\n        }\n        setShownGrades([...shownSize])\n    }\n\n    const changeGrade = async (e, k) => {\n        e.preventDefault()\n        try {\n            const data = await request(`/api/students/grade/${k}`, 'GET', null, {\n                Authorization: `Bearer ${token}`\n            })\n            if (data.message === 'Grade have changed'){\n                if (k == 1)\n                    notify('Класс всех учеников повышен')\n                else if (k == -1)\n                    notify('Класс всех учеников понижен')\n                fetchGrades(e)\n            }\n        }\n        catch (e) {}\n    }\n\n    useEffect(() => {\n\n        if (grades.length == 0) fetchGrades()\n        document.body.style = 'transition-duration: .5s; transition-timing-function: ease-in-out; background: white;'\n        document.title = 'Ученики'\n\n        if (shownGrades.length == 0)\n            showAll()\n\n    }, [fetchGrades, shownGrades, showAll])\n\n\n\n\n    return(\n        <div>\n            <h1 id = 'label' className = 'soft_appearing'>Ученики</h1>\n            <div className = 'searchSortAndAdd'>\n                <input type = 'text' id = 'search'\n                       className = {  isSearching === 'active' && 'searchAppearing' ||\n                       isSearching === 'inactive' && 'searchDisappearing' ||\n                       isSearching === 'none' && 'invisible'}\n                       placeholder = 'Поиск по ученикам и классам'onChange = {e => doSearch(e)}/>\n\n                { SearchIcon({ isSearching, handleSearchActivating }) }\n\n                <svg className = 'sortIcon' id = 'sortIcon' onClick = {e => doSort(e)} width=\"378px\" height=\"282px\" viewBox=\"0 0 378 282\" version=\"1.1\">\n                    <g id=\"Logo\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n                        <path d=\"M96.0389392,1 C106.609669,1 115.859436,5.58308193 120.9273,12.4308996 L121.015825,12.5525321 L184.479,88.185 L184.496508,88.1714212 C184.642609,88.3378163 184.787245,88.5063032 184.930373,88.6768766 C194.515421,100.099893 193.711394,116.554722 183.134527,125.429767 C172.70048,134.184972 156.653546,132.29306 147.020097,121.273869 L146.992363,121.296357 L121.038,90.365 L121.038939,199 L121.03148,199 C121.036443,199.221378 121.038939,199.443416 121.038939,199.666084 C121.038939,214.577772 109.846058,226.666084 96.0389392,226.666084 C82.2318205,226.666084 71.0389392,214.577772 71.0389392,199.666084 C71.0389392,199.443416 71.041435,199.221378 71.0463979,199 L71.0389392,199 L71.038,90.942 L46.409,120.293 L46.4188636,120.301213 C46.2803665,120.473988 46.1395549,120.645684 45.9964268,120.816257 C36.4113784,132.239273 20.0669169,134.304812 9.49005029,125.429767 C-0.91459931,116.699229 -1.8620698,100.633732 7.23426161,89.2388073 L7.21214233,89.2211541 L69.5356122,14.9464184 C74.0533978,6.728782 84.2205763,1 96.0389392,1 Z\" id=\"Combined-Shape\"\n                              stroke=\"#4A4A4A\" fill=\"#4A4A4A\"></path>\n                        <path d=\"M282.185638,55 C294.279566,55 304.644412,60.9990492 308.99572,69.5252612 L370.259061,142.536 L370.296508,142.505337 C370.442609,142.671732 370.587245,142.840219 370.730373,143.010793 C380.315421,154.433809 379.511394,170.888638 368.934527,179.763683 C358.495096,188.523405 342.436985,186.625021 332.805192,175.590722 L332.757304,175.630273 L306.803061,144.699 L306.80388,253.333916 L306.796421,253.333916 C306.801384,253.555294 306.80388,253.777332 306.80388,254 C306.80388,268.911688 295.610999,281 281.80388,281 C267.996761,281 256.80388,268.911688 256.80388,254 C256.80388,253.777332 256.806376,253.555294 256.811339,253.333916 L256.80388,253.333916 L256.803061,145.276 L232.172061,174.629 L232.179924,174.635129 C232.041427,174.807904 231.900616,174.9796 231.757488,175.150173 C222.172439,186.573189 205.827978,188.638728 195.251111,179.763683 C184.845967,171.03273 183.898901,154.96612 192.99662,143.571098 L192.977083,143.55507 L255.890594,68.5762614 C260.507198,60.5572584 270.545545,55 282.185638,55 Z\" id=\"Combined-Shape-Copy-10\"\n                              stroke=\"#D6D6D6\" fill=\"#D6D6D6\" transform=\"translate(282.092819, 168.000000) rotate(180.000000) translate(-282.092819, -168.000000) \"></path>\n                    </g>\n                </svg>\n\n                {/*<svg className = 'addIcon' id = 'addIcon' onClick = {e => handleAddActivating(e)} width=\"250px\" height=\"250px\" viewBox=\"0 0 250 250\" version=\"1.1\">*/}\n                {/*    <defs>*/}\n                {/*        <rect x=\"-1878\" y=\"25\" width=\"1935\" height=\"931\" id=\"rect-1\"></rect>*/}\n                {/*    </defs>*/}\n                {/*    <g id=\"Logo\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">*/}\n                {/*        <rect id=\"Rectangle-2\" className = {    isAdding === 'active' && 'activeFill' ||*/}\n                {/*                                                isAdding === 'inactive' && ' inactiveFill' ||*/}\n                {/*                                                isAdding === 'none' && 'inactiveFill'}*/}\n                {/*              transform=\"translate(125.000000, 125.000000) rotate(90.000000) translate(-125.000000, -125.000000) \" x=\"110\" y=\"85\" width=\"30\" height=\"80\" rx=\"15\"></rect>*/}\n                {/*        <rect id=\"Rectangle-1\"*/}\n                {/*              className = {     isAdding === 'active' && 'activeFill' ||*/}\n                {/*                    isAdding === 'inactive' && ' inactiveFill' ||*/}\n                {/*                    isAdding === 'none' && 'inactiveFill'}*/}\n                {/*              x=\"110\" y=\"85\" width=\"30\" height=\"80\" rx=\"15\"></rect>*/}\n                {/*        <circle id=\"Oval\"*/}\n                {/*                className = {   isAdding === 'active' && 'activeStroke' ||*/}\n                {/*                    isAdding === 'inactive' && ' inactiveStroke' ||*/}\n                {/*                    isAdding === 'none' && 'inactiveStroke'}*/}\n                {/*                stroke-width=\"50\" cx=\"125\" cy=\"125\" r=\"100\"></circle>*/}\n                {/*    </g>*/}\n                {/*</svg>*/}\n\n\n\n            </div>\n\n                {notFound && <h1 className = 'notFound'>Ничего не найдено</h1>}\n\n            <div id = 'gradesCollection' className = 'gradesCollection' >\n                {\n                    !notFound && grades &&\n                    grades.map((grade, index) =>\n                        {\n                            if (shownGrades.includes(index))\n                            return (\n                                <div className = 'gradeItem gradesAppearing' key = {index}>\n                                    <p className = 'grade'>{grade.grade}{grade.letter}</p>\n                                    <div className = 'students'>\n                                    {\n                                        grade.students.map((student, i) => {\n                                            if (/\\d/.test(search) || (student.name + student.surname).toString().toLowerCase().includes(search))\n                                                return (\n                                                    <NavLink to = {'/profile/' + student.username} key = {i} className = 'studentItem soft_appearing'>\n                                                        <div className = 'nameAndSurname'>\n                                                            <p>{student.name} {student.surname}</p>\n                                                        </div>\n                                                        <p className = 'pic'>{emojiToString(student.pic)}</p>\n                                                    </NavLink>\n                                                )\n                                        })\n                                    }\n                                    </div>\n                                </div>\n                            )\n                        })\n                }\n            </div>\n            <div className = 'addingStudent' id = 'addingStudent'>\n                    {/*<input type='text' id = 'type' name='type' placeholder='Тип' onChange={changeHandler} value = {form.type}/>*/}\n                <div className = 'addingStudentEmoji' onClick = { e => handleChooseEmojiActivating(e) } disabled={loading}>\n                    {emojiToString(form.pic)}\n                </div>\n\n                {\n                    isChoosingEmoji &&\n                    <div className = 'emojiContainer'>\n                        {\n                            emojis.map((emoji, i) => {\n                                return (\n                                    <div className = 'addingStudentEmoji' onClick = {e => setFormPic(e)} key = {i} id = {'e' + i}>\n                                        {emojiToString(emoji)}\n                                    </div>\n                                )\n                            })\n                        }\n                    </div>\n                }\n\n\n                {!isChoosingEmoji &&\n                <div className = 'addingStudentFormInputs'>\n                <input type='text' id='name' name='name' placeholder='Имя' onChange={e => changeHandler(e)}\n                       value={form.name}/>\n                    <p className = 'error' id = 'errorStudentName'>{errors.name}</p>\n                    <input type='text' id = 'surname' name='surname' placeholder='Фамилия' onChange={e => changeHandler(e)} value = {form.surname}/>\n                    <p className = 'error' id = 'errorStudentSurname'>{errors.surname}</p>\n\n                    <div className = 'gradeAndLetter'>\n                    <select name='grade' defaultValue = '' onChange={e => changeHandler(e)}>\n                    <option value = '' disabled>Класс</option>\n                    <option value = '1'>1</option>\n                    <option value = '2'>2</option>\n                    <option value = '3'>3</option>\n                    <option value = '4'>4</option>\n                    <option value = '5'>5</option>\n                    <option value = '6'>6</option>\n                    <option value = '7'>7</option>\n                    <option value = '8'>8</option>\n                    <option value = '9'>9</option>\n                    <option value = '10'>10</option>\n                    <option value = '11'>11</option>\n                    </select>\n                    <div></div>\n                    <select id = 'letter' name='letter' defaultValue = '' onChange={e => changeHandler(e)}>\n                    <option value = '' disabled>Буква</option>\n                    <option value = 'А'>А</option>\n                    <option value = 'Б'>Б</option>\n                    <option value = 'В'>В</option>\n                    <option value = 'Г'>Г</option>\n                    <option value = 'Д'>Д</option>\n                    </select>\n                    </div>\n\n                    <DatePicker selected = {date}\n                                value = {formatDateToRu(date)}\n                    onChange = {date => setBirthday(date)}\n                    placeholderText = 'Дата рождения'\n                    locale = 'ru' dateFormat=\"dd/MM/yyyy\"/>\n\n                    <input type='text' id = 'login' name='login' placeholder='Логин' onChange={e => changeHandler(e)} value = {form.login}/>\n                    <p className = 'error' id = 'errorStudentLogin'>{errors.login}</p>\n                    <input type='text' id = 'password' name='password' placeholder='Пароль' onChange={e => changeHandler(e)} value = {form.password}/>\n                    <p className = 'error' id = 'errorStudentPassword'>{errors.password}</p>\n\n                    <div className = 'longGreenBtn' onClick = {e => registerHandler(e)}>\n                        <p>Создать</p>\n                    </div>\n            </div> }\n\n                </div>\n\n            {\n                !notFound && grades &&\n                <div className = 'flexboxRow soft_appearing'>\n                    <div className = 'longGrayBtn' onClick = {e => changeGrade(e, -1)}>\n                        <p>Понизить класс</p>\n                    </div>\n                    <div className = 'longGreenBtn' onClick = {e => changeGrade(e, 1)}>\n                        <p>Повысить класс</p>\n                    </div>\n                </div>\n            }\n\n        </div>\n    )\n}\n\nexport default Students;"]},"metadata":{},"sourceType":"module"}