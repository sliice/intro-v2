{"ast":null,"code":"var _jsxFileName = \"/Users/alisakrylova/Intro/client/src/components/TestPage.js\";\nimport React, { useCallback, useContext, useEffect, useState } from 'react';\nimport './Appearence/index.css';\nimport './Appearence/TestPage.css';\nimport { AuthContext } from \"./Context/AuthContext\";\nimport { useHttp } from \"../Hooks/http.hook\";\nimport { useParams } from 'react-router-dom';\nimport { NavLink } from \"react-router-dom\";\nexport const TestPage = () => {\n  const link = useParams().id;\n  const [test, setTest] = useState({\n    name: '',\n    description: '',\n    shortDescription: '',\n    questions: [],\n    answers: []\n  });\n  const {\n    token,\n    userID,\n    username\n  } = useContext(AuthContext); // const [answers, setAnswers] = useState({userID: userID})\n\n  const [answers, setAnswers] = useState([]);\n  const {\n    loading,\n    request,\n    error,\n    clearError\n  } = useHttp();\n  const [content, setContent] = useState('description');\n  const [index, setIndex] = useState(0);\n  const [goNext, setGoNext] = useState(false);\n  const fetchTestData = useCallback(async () => {\n    try {\n      const fetched = await request(`/api/tests/${link}`, 'GET', null, {\n        Authorization: `Bearer ${token}`\n      });\n      setTest(fetched);\n    } catch (e) {}\n  }, [token, request]);\n\n  const showTest = e => {\n    e.preventDefault();\n    setContent('testStartPage');\n  };\n\n  const yesHandler = e => {\n    e.preventDefault();\n    document.getElementById('y' + index).style = 'transform: scale(1.2)';\n    document.getElementById('n' + index).style = 'transform: scale(1)';\n    setAnswers({ ...answers,\n      [\"a\" + e.target.id]: true\n    });\n    setGoNext(true);\n  };\n\n  const noHandler = e => {\n    e.preventDefault();\n    document.getElementById('y' + index).style = 'transform: scale(1)';\n    document.getElementById('n' + index).style = 'transform: scale(1.2)';\n    setAnswers({ ...answers,\n      [\"a\" + e.target.id]: false\n    });\n    setGoNext(true);\n  };\n\n  const next = e => {\n    e.preventDefault();\n\n    if (goNext) {\n      if (index < test.questions) setIndex(index + 1);\n      document.getElementById('y' + index).style = 'transform: scale(1)';\n      document.getElementById('n' + index).style = 'transform: scale(1)';\n\n      try {\n        document.getElementById('next' + index).style = 'transform: scale(1.2)';\n      } catch (e) {}\n\n      try {\n        document.getElementById('next' + index).style = 'transform: scale(1)';\n      } catch (e) {}\n\n      try {\n        document.getElementById('back' + index).style = 'transform: scale(1)';\n      } catch (e) {}\n\n      setGoNext(false);\n    }\n  };\n\n  const back = e => {\n    e.preventDefault();\n    if (index > 0) setIndex(index - 1);\n    document.getElementById('y' + index).style = 'transform: scale(1)';\n    document.getElementById('n' + index).style = 'transform: scale(1)';\n\n    try {\n      document.getElementById('next' + index).style = 'transform: scale(1)';\n    } catch (e) {}\n\n    try {\n      document.getElementById('back' + index).style = 'transform: scale(1.2)';\n    } catch (e) {}\n\n    setGoNext(false);\n  };\n\n  const handleAnswering = (e, i, j) => {\n    let answ = answers;\n    if (!answ[j]) answ[j] = [];\n    if (!answ[j].includes(i)) answ[j].push(i);\n\n    for (let k = 0; k < answ.length; k++) {\n      if (!answ[k]) answ[k] = [];else {\n        if (answ[k].includes(i)) {\n          let index = answ[k].indexOf(i);\n          if (index != -1 && j != k) answ[k].splice(index, 1);\n        }\n\n        answ[k].sort((a, b) => a > b ? 1 : -1);\n      }\n    }\n\n    setAnswers(answ);\n  };\n\n  const saveAnswers = async e => {\n    e.preventDefault();\n    console.log(link, username); // try {\n    //     const data = await request(`${link}/save`, 'POST', {userID, answers, link, date: new Date()})\n    //     console.log(data.message)\n    // }\n    // catch (e) {}\n  };\n\n  useEffect(() => {\n    fetchTestData();\n    if (content === 'testStartPage') document.body.style = 'transition-duration: 1s; transition-timing-function: ease-in-out; background: #E6EBC3;';\n  }, [fetchTestData, content]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 9\n    }\n  }, content === 'description' && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"testInfo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"bigTestName\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 21\n    }\n  }, test.name), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"testDescription\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 21\n    }\n  }, test.shortDescription, /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 21\n    }\n  }), test.description), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"button\",\n    className: \"redbtn\",\n    value: \"\",\n    disabled: loading,\n    onClick: showTest,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 21\n    }\n  })), content === 'testStartPage' && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 17\n    }\n  }, test.questions.map((question, i) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"questionCard\",\n      key: i,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 28\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 32\n      }\n    }, i + 1, \"/\", test.q), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 32\n      }\n    }, question), i > 0 && /*#__PURE__*/React.createElement(\"input\", {\n      type: \"button\",\n      className: \"nobtn\",\n      value: \"\\u043D\\u0430\\u0437\\u0430\\u0434\",\n      id: 'back' + i,\n      disabled: loading,\n      onClick: e => back(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 36\n      }\n    }), test.answers.map((answer, j) => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"registerbtn\",\n        key: j,\n        onClick: e => handleAnswering(e, i, j),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 40\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 44\n        }\n      }, answer));\n    }), i < test.q - 1 && /*#__PURE__*/React.createElement(\"input\", {\n      type: \"button\",\n      className: \"nobtn\",\n      value: \"\\u0434\\u0430\\u043B\\u044C\\u0448\\u0435\",\n      id: 'next' + i,\n      disabled: loading,\n      onClick: e => next(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 36\n      }\n    }));\n  }), /*#__PURE__*/React.createElement(NavLink, {\n    to: `/tests/${link}/${username}`,\n    disabled: loading,\n    onClick: e => saveAnswers(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 25\n    }\n  }, \"\\u0420\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442\"))));\n};\nexport default TestPage;","map":{"version":3,"sources":["/Users/alisakrylova/Intro/client/src/components/TestPage.js"],"names":["React","useCallback","useContext","useEffect","useState","AuthContext","useHttp","useParams","NavLink","TestPage","link","id","test","setTest","name","description","shortDescription","questions","answers","token","userID","username","setAnswers","loading","request","error","clearError","content","setContent","index","setIndex","goNext","setGoNext","fetchTestData","fetched","Authorization","e","showTest","preventDefault","yesHandler","document","getElementById","style","target","noHandler","next","back","handleAnswering","i","j","answ","includes","push","k","length","indexOf","splice","sort","a","b","saveAnswers","console","log","body","map","question","q","answer"],"mappings":"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","sourcesContent":["import React, {useCallback, useContext, useEffect, useState} from 'react'\nimport './Appearence/index.css'\nimport './Appearence/TestPage.css'\nimport {AuthContext} from \"./Context/AuthContext\";\nimport {useHttp} from \"../Hooks/http.hook\";\nimport {useParams} from 'react-router-dom'\nimport {NavLink} from \"react-router-dom\";\n\nexport const TestPage = () => {\n\n    const link = useParams().id\n\n    const [test, setTest] = useState({ name: '', description: '', shortDescription: '', questions: [], answers: []})\n    const {token, userID, username} = useContext(AuthContext)\n    // const [answers, setAnswers] = useState({userID: userID})\n    const [answers, setAnswers] = useState([])\n    const {loading, request, error, clearError} = useHttp();\n\n\n    const [content, setContent] = useState('description')\n    const [index, setIndex] = useState(0)\n    const [goNext, setGoNext] = useState(false)\n\n    const fetchTestData = useCallback(async () => {\n        try {\n            const fetched = await request(`/api/tests/${link}`, 'GET', null, {\n                Authorization: `Bearer ${token}`\n            })\n            setTest(fetched)\n        }\n        catch (e) {}\n    }, [token, request])\n\n    const showTest = e => {\n        e.preventDefault()\n        setContent('testStartPage')\n    }\n\n    const yesHandler = e => {\n        e.preventDefault()\n        document.getElementById('y' + index).style = 'transform: scale(1.2)'\n        document.getElementById('n' + index).style = 'transform: scale(1)'\n        setAnswers({...answers, [\"a\" + e.target.id]: true })\n        setGoNext(true)\n    }\n\n    const noHandler = e => {\n        e.preventDefault()\n        document.getElementById('y' + index).style = 'transform: scale(1)'\n        document.getElementById('n' + index).style = 'transform: scale(1.2)'\n        setAnswers({...answers, [\"a\" + e.target.id]: false })\n        setGoNext(true)\n    }\n\n    const next = e => {\n        e.preventDefault()\n        if (goNext){\n            if (index < test.questions)setIndex(index + 1)\n            document.getElementById('y' + index).style = 'transform: scale(1)'\n            document.getElementById('n' + index).style = 'transform: scale(1)'\n            try { document.getElementById('next' + index).style = 'transform: scale(1.2)' } catch (e) {}\n            try { document.getElementById('next' + index).style = 'transform: scale(1)' } catch (e) {}\n            try { document.getElementById('back' + index).style = 'transform: scale(1)' } catch (e) {}\n            setGoNext(false)\n        }\n    }\n\n    const back = e => {\n        e.preventDefault()\n        if (index > 0) setIndex(index - 1)\n        document.getElementById('y' + index).style = 'transform: scale(1)'\n        document.getElementById('n' + index).style = 'transform: scale(1)'\n        try { document.getElementById('next' + index).style = 'transform: scale(1)' } catch (e) {}\n        try { document.getElementById('back' + index).style = 'transform: scale(1.2)' } catch (e) {}\n        setGoNext(false)\n    }\n\n    const handleAnswering = (e, i, j) => {\n        let answ = answers\n\n        if (!answ[j])\n            answ[j] = []\n\n        if (!answ[j].includes(i))\n            answ[j].push(i)\n\n        for (let k = 0; k < answ.length; k++){\n            if (!answ[k])\n                answ[k] = []\n            else {\n                if (answ[k].includes(i)){\n                    let index = answ[k].indexOf(i)\n                    if (index != -1 && j != k)\n                        answ[k].splice(index, 1)\n                }\n                answ[k].sort((a, b) => a > b ? 1 : -1)\n            }\n        }\n\n        setAnswers(answ)\n    }\n\n    const saveAnswers = async (e) => {\n        e.preventDefault()\n        console.log(link, username)\n        // try {\n        //     const data = await request(`${link}/save`, 'POST', {userID, answers, link, date: new Date()})\n        //     console.log(data.message)\n        // }\n        // catch (e) {}\n    }\n\n    useEffect(() => {\n        fetchTestData()\n        if (content === 'testStartPage')\n            document.body.style = 'transition-duration: 1s; transition-timing-function: ease-in-out; background: #E6EBC3;'\n    }, [fetchTestData, content])\n\n\n    return (\n        <div>\n            { content === 'description' &&\n                <div className = 'testInfo'>\n                    <h1 className = 'bigTestName'>{test.name}</h1>\n                    <p className='testDescription'>{test.shortDescription}\n                    <br/>{test.description}</p>\n                    <input type='button' className = 'redbtn'  value = '' disabled={loading} onClick = {showTest} />\n                </div>\n            }\n\n            { content === 'testStartPage' &&\n                <div>\n                {\n                   test.questions.map((question, i) => {\n                       return (\n                           <div className = 'questionCard' key = {i}>\n                               <h1>{i + 1}/{test.q}</h1>\n                               <p>{question}</p>\n                               {\n                                   i > 0 &&\n                                   <input type='button' className = 'nobtn'  value = 'назад' id = {'back'+i} disabled={loading} onClick={e => back(e)}/>\n                               }\n\n                               {\n                                   test.answers.map((answer, j) => {\n                                       return(\n                                       <div className = 'registerbtn' key = {j} onClick = {(e) => handleAnswering(e, i, j)}>\n                                           <p>{answer}</p>\n                                       </div>)\n                                   })\n                               }\n\n                               {/*<input type='button' className = 'yesbtn'  value = 'да' id = {'y'+i} disabled={loading} onClick={e => yesHandler(e)}/>*/}\n                               {/*<input type='button' className = 'nobtn'  value = 'нет' id = {'n'+i} disabled={loading} onClick={e => noHandler(e)}/>*/}\n\n\n                               {\n                                   i < test.q - 1 &&\n                                   <input type='button' className = 'nobtn'  value = 'дальше' id = {'next'+i} disabled={loading} onClick={e => next(e)}/>\n                               }\n                           </div>\n                       )\n                        })\n                }\n                    {/*{*/}\n                    {/*    // index == test.questions - 1 &&*/}\n                        {/*<input type='button' className = 'yesbtn'  value = 'результат' disabled={loading} onClick={e => saveAnswers(e)}/>*/}\n                    {/*}*/}\n                    {/*<input type='button' className = 'yesbtn'  value = 'результат' disabled={loading} onClick={e => saveAnswers(e)}/>*/}\n                    <NavLink to = {`/tests/${link}/${username}`}\n                             disabled={loading}\n                             onClick={e => saveAnswers(e)}\n                    >\n                        <p>Результат</p>\n                    </NavLink>\n                </div>\n            }\n        </div>\n\n\n    )\n}\n\nexport default TestPage;"]},"metadata":{},"sourceType":"module"}