{"ast":null,"code":"var _jsxFileName = \"/Users/alisakrylova/Intro/client/src/components/Auth.js\";\nimport React, { useContext, useEffect, useState } from 'react';\n\nconst {\n  Router\n} = require('express');\n\nimport './Appearence/App.css';\nimport './Appearence/Auth.css';\nimport { useHttp } from \"../hooks/http.hook\";\nimport { useMessage } from \"../hooks/message.hook\";\nimport { AuthContext } from \"./context/AuthContext\";\nconst router = Router();\nexport const Auth = () => {\n  const auth = useContext(AuthContext);\n  const {\n    loading,\n    request,\n    error,\n    clearError\n  } = useHttp();\n  const [form, setForm] = useState({\n    login: '',\n    password: ''\n  });\n  const message = useMessage();\n  useEffect(() => {\n    message(error);\n    clearError();\n  }, [error, message, clearError]);\n\n  const changeHandler = event => {\n    setForm({ ...form,\n      [event.target.name]: event.target.value\n    });\n  };\n\n  const registerHandler = async () => {\n    try {\n      const data = await request('api/auth/register', 'POST', { ...form\n      });\n      console.log(data.message);\n    } catch (e) {}\n  };\n\n  const loginHandler = async () => {\n    try {\n      const data = await request('api/auth/login', 'POST', { ...form\n      });\n      router.get('/', auth, async (req, res) => {\n        try {\n          const users = await User.find({\n            _id: req.user.userID\n          });\n          res.json(users);\n          console.log(res);\n        } catch (e) {\n          res.status(500).json({\n            message: \"Something went wrong. Try again\"\n          });\n        }\n      });\n      console.log(data.message);\n      auth.login(data.token, data.userID, data.userType);\n      console.log('USER TYPE: ', data.userType);\n    } catch (e) {}\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"authform\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"login\",\n    name: \"login\",\n    placeholder: \"\\u041B\\u043E\\u0433\\u0438\\u043D\",\n    onChange: changeHandler,\n    value: form.email,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"password\",\n    id: \"password\",\n    name: \"password\",\n    placeholder: \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",\n    onChange: changeHandler,\n    value: form.password,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 19\n    }\n  })), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"button\",\n    className: \"loginbtn\",\n    onClick: loginHandler,\n    disabled: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 15\n    }\n  }));\n};\nexport default Auth;","map":{"version":3,"sources":["/Users/alisakrylova/Intro/client/src/components/Auth.js"],"names":["React","useContext","useEffect","useState","Router","require","useHttp","useMessage","AuthContext","router","Auth","auth","loading","request","error","clearError","form","setForm","login","password","message","changeHandler","event","target","name","value","registerHandler","data","console","log","e","loginHandler","get","req","res","users","User","find","_id","user","userID","json","status","token","userType","email"],"mappings":"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","sourcesContent":["import React, {useContext, useEffect, useState} from 'react';\nconst {Router} = require('express')\nimport './Appearence/App.css';\nimport './Appearence/Auth.css';\nimport {useHttp} from \"../hooks/http.hook\";\nimport {useMessage} from \"../hooks/message.hook\";\nimport {AuthContext} from \"./context/AuthContext\";\nconst router = Router()\n\nexport const Auth = () => {\n    const auth = useContext(AuthContext)\n    const {loading, request, error, clearError} = useHttp();\n    const [form, setForm] = useState({ login: '', password: '' })\n    const message = useMessage()\n\n    useEffect(() => {\n        message(error)\n        clearError()\n    }, [error, message, clearError])\n\n     const changeHandler = event => {\n         setForm({...form, [event.target.name]: event.target.value})\n     }\n\n     const registerHandler = async () => {\n         try {\n          const data = await request('api/auth/register', 'POST', {...form})\n             console.log(data.message)\n         }\n         catch (e) {}\n     }\n\n    const loginHandler = async () => {\n        try {\n            const data = await request('api/auth/login', 'POST', {...form})\n            router.get('/', auth, async (req, res) => {\n                try {\n                    const users = await User.find({ _id: req.user.userID })\n                    res.json(users)\n                    console.log(res)\n                }\n                catch(e){\n                    res.status(500).json({ message: \"Something went wrong. Try again\" })\n                }\n            })\n            console.log(data.message)\n            auth.login(data.token, data.userID, data.userType)\n            console.log('USER TYPE: ', data.userType)\n        }\n        catch (e) {}\n    }\n\n\n      return (\n          <div>\n              <div className = 'authform'>\n                  <input type='text' id = 'login' name='login' placeholder='Логин' onChange={changeHandler} value = {form.email}/>\n                  <input type='password' id = 'password' name='password' placeholder='Пароль' onChange={changeHandler} value = {form.password}/>\n              </div>\n              {/*<input type='button' value='Войти' onClick = {registerHandler} disabled={loading}/>*/}\n              <input type='button' className = 'loginbtn' onClick = {loginHandler} disabled={loading}/>\n          </div>\n      )\n}\n\nexport default Auth"]},"metadata":{},"sourceType":"module"}