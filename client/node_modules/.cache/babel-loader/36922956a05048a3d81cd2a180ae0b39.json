{"ast":null,"code":"var _jsxFileName = \"/Users/alisakrylova/Intro/client/src/components/Students.js\";\nimport React, { useCallback, useContext, useEffect, useState } from 'react';\nimport './Appearence/index.css';\nimport './Appearence/Auth.css';\nimport { useHttp } from \"../Hooks/http.hook\";\nimport { AuthContext } from \"./Context/AuthContext\";\nimport { NavLink } from \"react-router-dom\";\nexport const Students = () => {\n  const {\n    loading,\n    request,\n    error,\n    clearError\n  } = useHttp();\n  const [form, setForm] = useState({\n    login: '',\n    password: '',\n    type: '',\n    pic: '',\n    name: '',\n    surname: '',\n    grade: null,\n    letter: '',\n    birthdate: ''\n  });\n  const [students, setStudents] = useState([]);\n  const [shown, setShown] = useState([]);\n  const [isSearching, activateSearching] = useState('none');\n  const [search, setSearch] = useState('');\n  const {\n    token\n  } = useContext(AuthContext);\n\n  const changeHandler = event => {\n    setForm({ ...form,\n      [event.target.name]: event.target.value\n    });\n  };\n\n  const registerHandler = async () => {\n    try {\n      const data = await request('api/students/create', 'POST', { ...form\n      });\n      console.log(data.message);\n\n      if (data.message === 'User\\'ve created') {\n        setForm({\n          login: '',\n          password: '',\n          type: '',\n          pic: '',\n          name: '',\n          surname: '',\n          grade: null,\n          letter: '',\n          birthdate: ''\n        });\n      }\n    } catch (e) {}\n  };\n\n  const fetchStudents = useCallback(async () => {\n    try {\n      const fetched = await request('/api/students', 'GET', null, {\n        Authorization: `Bearer ${token}`\n      });\n      fetched.sort((a, b) => a.grade > b.grade ? 1 : -1);\n      setStudents(fetched);\n    } catch (e) {}\n  }, [token, request]);\n\n  const setSearchFilter = e => {\n    e.preventDefault();\n    let search = e.target.value.toString().toLowerCase();\n    setSearch(search);\n    if (search != '') doSearch();else showAll();\n  };\n\n  const doSearch = e => {\n    try {\n      if (search != '') {\n        let resultsArray = [];\n        results.map(result => {\n          let res = '';\n          result.result.map(r => {\n            res += r.scaleResult.toString();\n          });\n          resultsArray.push((result.test + res).toString().toLowerCase());\n        });\n        let indexes = [];\n        resultsArray.map((result, i) => {\n          if (resultsArray[i].toString().includes(search)) indexes.push(i);\n        });\n        if (indexes.length != 0) setShown([...indexes]);else showAll();\n      } else showAll();\n    } catch (e) {}\n  };\n\n  const showAll = () => {\n    let shownSize = [];\n\n    for (let i = 0; i < results.length; i++) {\n      shownSize.push(i);\n    }\n\n    setShown([...shownSize]);\n  };\n\n  useEffect(() => {\n    fetchStudents();\n    document.body.style = 'transition-duration: .5s; transition-timing-function: ease-in-out; background: white;'; // console.log('😊'.codePointAt())\n    // console.log(String.fromCodePoint(128522))\n  }, [fetchStudents]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 13\n    }\n  }, \"\\u0423\\u0447\\u0435\\u043D\\u0438\\u043A\\u0438\"), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"testsCollection\",\n    className: \"tests\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 13\n    }\n  }, students.map((student, index) => {\n    return /*#__PURE__*/React.createElement(NavLink, {\n      to: '/profile/' + student.user,\n      key: index,\n      className: \"testItem soft_appearing\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: \"testName\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 29\n      }\n    }, student.name, \" \", student.surname), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"testName\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 29\n      }\n    }, student.birthdate), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"testName\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 29\n      }\n    }, student.grade, student.letter), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"testName\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 29\n      }\n    }, String.fromCodePoint(student.pic)));\n  })));\n};\nexport default Students;","map":{"version":3,"sources":["/Users/alisakrylova/Intro/client/src/components/Students.js"],"names":["React","useCallback","useContext","useEffect","useState","useHttp","AuthContext","NavLink","Students","loading","request","error","clearError","form","setForm","login","password","type","pic","name","surname","grade","letter","birthdate","students","setStudents","shown","setShown","isSearching","activateSearching","search","setSearch","token","changeHandler","event","target","value","registerHandler","data","console","log","message","e","fetchStudents","fetched","Authorization","sort","a","b","setSearchFilter","preventDefault","toString","toLowerCase","doSearch","showAll","resultsArray","results","map","result","res","r","scaleResult","push","test","indexes","i","includes","length","shownSize","document","body","style","student","index","user","String","fromCodePoint"],"mappings":"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","sourcesContent":["import React, {useCallback, useContext, useEffect, useState} from 'react';\nimport './Appearence/index.css'\nimport './Appearence/Auth.css';\nimport {useHttp} from \"../Hooks/http.hook\";\nimport {AuthContext} from \"./Context/AuthContext\";\nimport {NavLink} from \"react-router-dom\";\n\n\nexport const Students = () => {\n\n    const {loading, request, error, clearError} = useHttp();\n\n    const [form, setForm] = useState({\n        login: '',\n        password: '',\n        type: '',\n        pic: '',\n        name: '',\n        surname: '',\n        grade: null,\n        letter: '',\n        birthdate: ''\n    })\n    const [students, setStudents] = useState([])\n    const [shown, setShown] = useState([])\n    const [isSearching, activateSearching] = useState('none')\n    const [search, setSearch] = useState('')\n    const {token} = useContext(AuthContext)\n\n    const changeHandler = event => {\n        setForm({...form, [event.target.name]: event.target.value})\n    }\n\n    const registerHandler = async () => {\n        try {\n            const data = await request('api/students/create', 'POST', {...form})\n            console.log(data.message)\n            if (data.message === 'User\\'ve created'){\n                setForm({\n                    login: '',\n                    password: '',\n                    type: '',\n                    pic: '',\n                    name: '',\n                    surname: '',\n                    grade: null,\n                    letter: '',\n                    birthdate: ''\n                })\n            }\n        }\n        catch (e) {}\n    }\n\n    const fetchStudents = useCallback(async () => {\n        try {\n            const fetched = await request('/api/students', 'GET', null, {\n                Authorization: `Bearer ${token}`\n            })\n            fetched.sort((a, b) => a.grade > b.grade ? 1 : -1);\n            setStudents(fetched)\n\n        } catch (e) {}\n    }, [token, request])\n\n\n    const setSearchFilter = e => {\n        e.preventDefault()\n        let search = e.target.value.toString().toLowerCase()\n        setSearch(search)\n        if (search != '')\n            doSearch()\n        else showAll()\n    }\n\n        const doSearch = e => {\n            try {\n                if (search != '') {\n                    let resultsArray = []\n                    results.map(result => {\n                        let res = ''\n                        result.result.map(r => {\n                            res += r.scaleResult.toString()\n                        })\n                        resultsArray.push((result.test + res).toString().toLowerCase())\n                    })\n\n                    let indexes = []\n                    resultsArray.map((result, i) => {\n                        if (resultsArray[i].toString().includes(search))\n                            indexes.push(i)\n                    })\n\n                    if (indexes.length != 0)\n                        setShown([...indexes])\n                    else showAll()\n                }\n                else showAll()\n            }\n            catch (e) {}\n        }\n\n        const showAll = () => {\n            let shownSize = []\n            for (let i = 0; i < results.length; i++){\n                shownSize.push(i)\n            }\n            setShown([...shownSize])\n        }\n\n\n\n\n\n\n    useEffect(() => {\n        fetchStudents()\n        document.body.style = 'transition-duration: .5s; transition-timing-function: ease-in-out; background: white;'\n        // console.log('😊'.codePointAt())\n        // console.log(String.fromCodePoint(128522))\n    }, [fetchStudents])\n\n    return(\n        <div>\n            <h1>Ученики</h1>\n            {/*<div className = 'authform'>*/}\n            {/*    <input type='text' id = 'login' name='login' placeholder='Логин' onChange={changeHandler} value = {form.login}/>*/}\n            {/*    <input type='text' id = 'password' name='password' placeholder='Пароль' onChange={changeHandler} value = {form.password}/>*/}\n            {/*    <input type='text' id = 'type' name='type' placeholder='Тип' onChange={changeHandler} value = {form.type}/>*/}\n            {/*    <input type='text' id = 'name' name='name' placeholder='Имя' onChange={changeHandler} value = {form.name}/>*/}\n            {/*    <input type='text' id = 'surname' name='surname' placeholder='Фамилия' onChange={changeHandler} value = {form.surname}/>*/}\n            {/*    { form.type === 'u' &&*/}\n            {/*        <input type='text' id = 'grade' name='grade' placeholder='Класс' onChange={changeHandler} value = {form.grade}/>}*/}\n            {/*    { form.type === 'u' &&*/}\n            {/*        <input type='text' id = 'letter' name='letter' placeholder='Буква' onChange={changeHandler} value = {form.letter}/>}*/}\n            {/*    { students.map((student) => {*/}\n            {/*        return (*/}\n            {/*            <div key = {student._id} className = 'authform'>*/}\n            {/*                /!*<h2>{student._id}</h2>*!/*/}\n            {/*                <h2>{student.grade}{student.letter}</h2>*/}\n            {/*                <h2>{student.name} {student.surname}</h2>*/}\n            {/*            </div>*/}\n            {/*        )*/}\n            {/*    }) }*/}\n            {/*</div>*/}\n            {/*<input type='button' className = 'loginbtn' value='reg' onClick = {registerHandler} disabled={loading}/>*/}\n            <div id = 'testsCollection' className = 'tests'>\n                { students.map((student, index) => {\n                    return (\n                        <NavLink to = {'/profile/' + student.user} key = {index} className = 'testItem soft_appearing'>\n                            <p className = 'testName'>{student.name} {student.surname}</p>\n                            <p className = 'testName'>{student.birthdate}</p>\n                            <p className = 'testName'>{student.grade}{student.letter}</p>\n                            <p className = 'testName'>{String.fromCodePoint(student.pic)}</p>\n                        </NavLink>\n                    )\n                })}\n            </div>\n        </div>\n    )\n}\n\nexport default Students;"]},"metadata":{},"sourceType":"module"}