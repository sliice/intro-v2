{"ast":null,"code":"var _jsxFileName = \"/Users/alisakrylova/Intro/client/src/components/ProfileViewForStudents.js\";\nimport React, { useCallback, useContext, useEffect, useState } from 'react';\nimport { useParams } from \"react-router-dom\";\nimport './Appearence/Profile.css';\nimport './Appearence/index.css';\nimport { AuthContext } from \"./Context/AuthContext\";\nimport { useHttp } from \"../Hooks/http.hook\";\nimport { NavLink } from \"react-router-dom\";\nimport { Emoji } from \"./Context/Emoji\";\nimport { RegExps } from \"./Context/RegExps\";\nimport * as cyrToTranslit from 'cyrillic-to-translit-js';\nexport const Profile = () => {\n  let username = useParams().id;\n  const {\n    loading,\n    request\n  } = useHttp(); // const {token, userID, name, surname, username, userType} = useContext(AuthContext)\n\n  const {\n    token,\n    userID\n  } = useContext(AuthContext);\n  const {\n    emojis\n  } = useContext(Emoji);\n  const [results, setResults] = useState([]);\n  const [shown, setShown] = useState([]);\n  const [isSearching, activateSearching] = useState('none');\n  const [isEditing, activateEditing] = useState(false);\n  const [isChoosingEmoji, activateChoosingEmoji] = useState(false);\n  const [search, setSearch] = useState('');\n  const [notFound, setNotFound] = useState();\n  const [sorted, setSorted] = useState(false);\n  const [resultsFetched, setResultsFetched] = useState(false);\n  const [userDataFetched, setUserDataFetched] = useState(false);\n  const [userData, setUserData] = useState({\n    name: '',\n    surname: '',\n    login: '',\n    type: '',\n    pic: '',\n    birthdate: ''\n  });\n  const [userEditedData, setUserEditedData] = useState({\n    pic: ''\n  });\n\n  const showAll = () => {\n    let shownSize = [];\n\n    for (let i = 0; i < results.length; i++) {\n      shownSize.push(i);\n    }\n\n    setShown([...shownSize]);\n  };\n\n  const fetchUserData = useCallback(async () => {\n    try {\n      const fetched = await request(`/users/get/${username}`, 'GET', null, {\n        Authorization: `Bearer ${token}`\n      });\n      setUserData(fetched);\n      setUserEditedData(fetched);\n      setUserDataFetched(true);\n    } catch (e) {}\n  }, [token, username]);\n  const fetchResults = useCallback(async () => {\n    try {\n      const fetched = await request(`/results/${username}`, 'GET', null, {\n        Authorization: `Bearer ${token}`\n      });\n      fetched.sort((a, b) => a.result[0].date > b.result[0].date ? 1 : -1);\n      setResults(fetched);\n      setResultsFetched(true);\n    } catch (e) {}\n  }, [token, userID, username]);\n\n  const handleSearchActivating = e => {\n    e.preventDefault();\n\n    switch (isSearching) {\n      case 'active':\n        activateSearching('inactive');\n        break;\n\n      case 'none':\n      case 'inactive':\n        activateSearching('active');\n        document.getElementById('search').focus();\n        break;\n    }\n  };\n\n  const doSearch = e => {\n    e.preventDefault();\n\n    try {\n      let searchFilter = e.target.value.toString().toLowerCase();\n      setSearch(searchFilter);\n      setNotFound(false);\n\n      if (searchFilter != '') {\n        let resultsArray = [];\n        results.map(result => {\n          let res = '';\n          result.result.map(r => {\n            res += r.scaleResult.toString();\n          });\n          resultsArray.push((result.test + res).toString().toLowerCase());\n        });\n        let indexes = [];\n        resultsArray.map((result, i) => {\n          if (resultsArray[i].toString().includes(searchFilter)) indexes.push(i);\n        });\n\n        if (indexes.length != 0) {\n          setShown([...indexes]);\n          setNotFound(false);\n        } else setNotFound(true);\n      } else showAll();\n    } catch (e) {}\n  };\n\n  const doSort = e => {\n    e.preventDefault();\n\n    try {\n      switch (sorted) {\n        case true:\n          document.getElementById('sortIcon').style = 'transform: rotate(360deg);';\n          document.getElementById('resultsCollection').style = 'flex-direction: column;';\n          setSorted(false);\n          break;\n\n        case false:\n          document.getElementById('sortIcon').style = 'transform: rotate(180deg);';\n          document.getElementById('resultsCollection').style = 'flex-direction: column-reverse;';\n          setSorted(true);\n          break;\n      }\n    } catch (e) {}\n  };\n\n  const handleEditActivating = e => {\n    e.preventDefault();\n    activateEditing(!isEditing);\n  };\n\n  const handleEditing = e => {\n    e.preventDefault();\n    setUserEditedData({ ...userEditedData,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const handleChooseEmojiActivating = e => {\n    e.preventDefault();\n    activateChoosingEmoji(!isChoosingEmoji);\n  };\n\n  const saveEditedData = async e => {\n    e.persist();\n\n    try {\n      const data = await request('/users/edit', 'POST', { ...userEditedData,\n        oldLogin: userData.login\n      });\n      console.log(data.message);\n      setUserData(userEditedData);\n    } catch (e) {}\n  };\n\n  const setUserPic = e => {\n    e.preventDefault();\n    setUserEditedData({ ...userEditedData,\n      pic: emojis[e.target.id.slice(1)]\n    });\n    saveEditedData(e);\n  };\n\n  useEffect(() => {\n    document.body.style = 'transition-duration: .7s; transition-timing-function: ease-in-out; background: white;'; //   // !resultsFetched && username !== userData.login && fetchResults()\n    //   // !userDataFetched && username !== userData.login && fetchUserData()\n\n    fetchUserData();\n    fetchResults();\n    if (shown.length == 0) showAll();\n  }, [resultsFetched, userDataFetched, username]);\n\n  const emojiToString = arr => {\n    let str = '';\n\n    if (arr) {\n      for (let i = 0; i < arr.length; i++) {\n        return String.fromCodePoint(arr[i]);\n      }\n    }\n\n    return str;\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profileContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profileEditingPic\",\n    onClick: e => handleChooseEmojiActivating(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 17\n    }\n  }, \" \", emojiToString(userEditedData.pic), \" \"), isChoosingEmoji && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"emojiContainerOnProfile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profileEditingPic\",\n    onClick: e => handleChooseEmojiActivating(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 25\n    }\n  }, \" \", emojiToString(userEditedData.pic), \" \"), emojis.map((emoji, i) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"addingStudentEmoji\",\n      onClick: e => setUserPic(e),\n      key: i,\n      id: 'e' + i,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 37\n      }\n    }, emojiToString(emoji));\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profileHeader\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    id: \"fio\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 21\n    }\n  }, userData.name, \" \", userData.surname), /*#__PURE__*/React.createElement(\"h2\", {\n    id: \"loginOnProfile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 21\n    }\n  }, userData.login), userData.type === 's' && /*#__PURE__*/React.createElement(\"h3\", {\n    id: \"type\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 21\n    }\n  }, \"\\u0423\\u0447\\u0435\\u043D\\u0438\\u043A\"), isEditing && /*#__PURE__*/React.createElement(\"div\", {\n    id: \"saveAndCancelEditing\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    id: \"cancelIcon\",\n    onClick: e => cancelEditing(e),\n    width: \"35px\",\n    height: \"35px\",\n    viewBox: \"0 0 300 300\",\n    version: \"1.1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    fill: \"#E88732\",\n    id: \"Logo\",\n    stroke: \"none\",\n    \"stroke-width\": \"1\",\n    \"fill-rule\": \"evenodd\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M231.885822,72.3223305 C241.64893,82.0854378 241.64893,97.9145622 231.885822,107.67767 L184.959,154.604 L222.885822,192.530483 C232.64893,202.293591 232.64893,218.122715 222.885822,227.885822 C213.122715,237.64893 197.293591,237.64893 187.530483,227.885822 L149.604,189.959 L111.67767,227.885822 C101.914562,237.64893 86.0854378,237.64893 76.3223305,227.885822 C66.5592232,218.122715 66.5592232,202.293591 76.3223305,192.530483 L114.249,154.604 L67.3223305,107.67767 C57.5592232,97.9145622 57.5592232,82.0854378 67.3223305,72.3223305 C77.0854378,62.5592232 92.9145622,62.5592232 102.67767,72.3223305 L149.604,119.249 L196.530483,72.3223305 C206.293591,62.5592232 222.122715,62.5592232 231.885822,72.3223305 Z\",\n    id: \"Combined-Shape\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 37\n    }\n  }))), /*#__PURE__*/React.createElement(\"svg\", {\n    id: \"saveIcon\",\n    onClick: e => saveEditedData(e),\n    width: \"30px\",\n    height: \"30px\",\n    viewBox: \"0 0 300 300\",\n    version: \"1.1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Logo\",\n    fill: \"#E0E7B4\",\n    stroke: \"none\",\n    \"stroke-width\": \"1\",\n    \"fill-rule\": \"evenodd\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M274.847645,60.3120342 L279.170453,64.6298082 C288.939247,74.3872257 288.948469,90.2163475 279.191052,99.9851413 C279.18419,99.9920115 279.177324,99.9988777 279.170453,100.00574 L151.781477,227.246365 C146.461489,232.560158 139.343499,234.977726 132.387469,234.499068 C125.431382,234.977957 118.312965,232.560413 112.992721,227.246365 L21.3326328,135.693019 C11.563839,125.935602 11.5546167,110.10648 21.3120342,100.337686 L21.3326328,100.317087 L21.3326328,100.317087 L25.655441,95.9993134 C35.4161868,86.2499345 51.2294296,86.2499345 60.9901754,95.9993134 L132.387,167.312 L239.512911,60.3120342 C249.273657,50.5626553 265.086899,50.5626553 274.847645,60.3120342 Z\",\n    id: \"Combined-Shape\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 37\n    }\n  })))))), results.length != 0 && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"searchAndSort\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"search\",\n    className: isSearching === 'active' && 'searchAppearing' || isSearching === 'inactive' && 'searchDisappearing' || isSearching === 'none' && 'invisible',\n    placeholder: \"\\u041F\\u043E\\u0438\\u0441\\u043A \\u043F\\u043E \\u0440\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442\\u0430\\u043C\",\n    onChange: doSearch,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"searchIcon\",\n    name: \"searchIcon\",\n    width: \"250px\",\n    height: \"277px\",\n    viewBox: \"0 0 250 277\",\n    version: \"1.1\",\n    onClick: handleSearchActivating,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Logo\",\n    stroke: \"none\",\n    \"stroke-width\": \"1\",\n    fill: \"none\",\n    \"fill-rule\": \"evenodd\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    className: isSearching === 'active' && 'activeStroke activeFill' || isSearching === 'inactive' && 'inactiveStroke inactiveFill' || isSearching === 'none' && 'inactiveStroke inactiveFill',\n    d: \"M256.23536,245.633373 C256.240323,245.854751 256.242819,246.076789 256.242819,246.299457 C256.242819,261.211145 245.049938,273.299457 231.242819,273.299457 C217.4357,273.299457 206.242819,261.211145 206.242819,246.299457 C206.242819,246.076789 206.245315,245.854751 206.250278,245.633373 Z\",\n    id: \"Combined-Shape\",\n    transform: \"translate(231.242819, 259.466415) rotate(-40.000000) translate(-231.242819, -259.466415) \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"rect\", {\n    id: \"Rectangle\",\n    className: isSearching === 'active' && 'activeStroke activeFill' || isSearching === 'inactive' && 'inactiveStroke inactiveFill' || isSearching === 'none' && 'inactiveStroke inactiveFill',\n    transform: \"translate(199.856726, 222.096267) rotate(-40.000000) translate(-199.856726, -222.096267) \",\n    x: \"174.856726\",\n    y: \"186.596267\",\n    width: \"50\",\n    height: \"71\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"circle\", {\n    id: \"Oval\",\n    className: isSearching === 'active' && 'activeStroke' || isSearching === 'inactive' && 'inactiveStroke' || isSearching === 'none' && 'inactiveStroke',\n    \"stroke-width\": \"50\",\n    cx: \"125\",\n    cy: \"125\",\n    r: \"100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"sortIcon\",\n    id: \"sortIcon\",\n    onClick: doSort,\n    width: \"378px\",\n    height: \"282px\",\n    viewBox: \"0 0 378 282\",\n    version: \"1.1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Logo\",\n    stroke: \"none\",\n    \"stroke-width\": \"1\",\n    fill: \"none\",\n    \"fill-rule\": \"evenodd\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M96.0389392,1 C106.609669,1 115.859436,5.58308193 120.9273,12.4308996 L121.015825,12.5525321 L184.479,88.185 L184.496508,88.1714212 C184.642609,88.3378163 184.787245,88.5063032 184.930373,88.6768766 C194.515421,100.099893 193.711394,116.554722 183.134527,125.429767 C172.70048,134.184972 156.653546,132.29306 147.020097,121.273869 L146.992363,121.296357 L121.038,90.365 L121.038939,199 L121.03148,199 C121.036443,199.221378 121.038939,199.443416 121.038939,199.666084 C121.038939,214.577772 109.846058,226.666084 96.0389392,226.666084 C82.2318205,226.666084 71.0389392,214.577772 71.0389392,199.666084 C71.0389392,199.443416 71.041435,199.221378 71.0463979,199 L71.0389392,199 L71.038,90.942 L46.409,120.293 L46.4188636,120.301213 C46.2803665,120.473988 46.1395549,120.645684 45.9964268,120.816257 C36.4113784,132.239273 20.0669169,134.304812 9.49005029,125.429767 C-0.91459931,116.699229 -1.8620698,100.633732 7.23426161,89.2388073 L7.21214233,89.2211541 L69.5356122,14.9464184 C74.0533978,6.728782 84.2205763,1 96.0389392,1 Z\",\n    id: \"Combined-Shape\",\n    stroke: \"#4A4A4A\",\n    fill: \"#4A4A4A\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M282.185638,55 C294.279566,55 304.644412,60.9990492 308.99572,69.5252612 L370.259061,142.536 L370.296508,142.505337 C370.442609,142.671732 370.587245,142.840219 370.730373,143.010793 C380.315421,154.433809 379.511394,170.888638 368.934527,179.763683 C358.495096,188.523405 342.436985,186.625021 332.805192,175.590722 L332.757304,175.630273 L306.803061,144.699 L306.80388,253.333916 L306.796421,253.333916 C306.801384,253.555294 306.80388,253.777332 306.80388,254 C306.80388,268.911688 295.610999,281 281.80388,281 C267.996761,281 256.80388,268.911688 256.80388,254 C256.80388,253.777332 256.806376,253.555294 256.811339,253.333916 L256.80388,253.333916 L256.803061,145.276 L232.172061,174.629 L232.179924,174.635129 C232.041427,174.807904 231.900616,174.9796 231.757488,175.150173 C222.172439,186.573189 205.827978,188.638728 195.251111,179.763683 C184.845967,171.03273 183.898901,154.96612 192.99662,143.571098 L192.977083,143.55507 L255.890594,68.5762614 C260.507198,60.5572584 270.545545,55 282.185638,55 Z\",\n    id: \"Combined-Shape-Copy-10\",\n    stroke: \"#D6D6D6\",\n    fill: \"#D6D6D6\",\n    transform: \"translate(282.092819, 168.000000) rotate(180.000000) translate(-282.092819, -168.000000) \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 25\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"resultsCollection\",\n    className: \"results\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 13\n    }\n  }, notFound && /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"notFound\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 33\n    }\n  }, \"\\u041D\\u0438\\u0447\\u0435\\u0433\\u043E \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E\") || !notFound && results.map((result, index) => {\n    if (shown.includes(index)) {\n      return /*#__PURE__*/React.createElement(NavLink, {\n        to: '/',\n        key: index,\n        className: \"resultItem soft_appearing\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"resultTestName\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 37\n        }\n      }, result.test), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"shortResult\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 37\n        }\n      }, result.result.map((result, i) => {\n        return /*#__PURE__*/React.createElement(\"p\", {\n          key: i,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 57\n          }\n        }, result.scaleResult);\n      })));\n    }\n  })));\n};\nexport default Profile;","map":{"version":3,"sources":["/Users/alisakrylova/Intro/client/src/components/ProfileViewForStudents.js"],"names":["React","useCallback","useContext","useEffect","useState","useParams","AuthContext","useHttp","NavLink","Emoji","RegExps","cyrToTranslit","Profile","username","id","loading","request","token","userID","emojis","results","setResults","shown","setShown","isSearching","activateSearching","isEditing","activateEditing","isChoosingEmoji","activateChoosingEmoji","search","setSearch","notFound","setNotFound","sorted","setSorted","resultsFetched","setResultsFetched","userDataFetched","setUserDataFetched","userData","setUserData","name","surname","login","type","pic","birthdate","userEditedData","setUserEditedData","showAll","shownSize","i","length","push","fetchUserData","fetched","Authorization","e","fetchResults","sort","a","b","result","date","handleSearchActivating","preventDefault","document","getElementById","focus","doSearch","searchFilter","target","value","toString","toLowerCase","resultsArray","map","res","r","scaleResult","test","indexes","includes","doSort","style","handleEditActivating","handleEditing","handleChooseEmojiActivating","saveEditedData","persist","data","oldLogin","console","log","message","setUserPic","slice","body","emojiToString","arr","str","String","fromCodePoint","emoji","cancelEditing","index"],"mappings":"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","sourcesContent":["import React, {useCallback, useContext, useEffect, useState} from 'react'\nimport {useParams} from \"react-router-dom\";\nimport './Appearence/Profile.css'\nimport './Appearence/index.css'\nimport {AuthContext} from \"./Context/AuthContext\"\nimport {useHttp} from \"../Hooks/http.hook\"\nimport {NavLink} from \"react-router-dom\"\nimport {Emoji} from \"./Context/Emoji\"\nimport {RegExps} from \"./Context/RegExps\"\nimport * as cyrToTranslit from 'cyrillic-to-translit-js'\n\nexport const Profile = () => {\n\n\n    let username = useParams().id\n    const {loading, request} = useHttp();\n\n    // const {token, userID, name, surname, username, userType} = useContext(AuthContext)\n    const {token, userID} = useContext(AuthContext)\n    const {emojis} = useContext(Emoji)\n    const [results, setResults] = useState([])\n    const [shown, setShown] = useState([])\n    const [isSearching, activateSearching] = useState('none')\n    const [isEditing, activateEditing] = useState(false)\n    const [isChoosingEmoji, activateChoosingEmoji] = useState(false)\n    const [search, setSearch] = useState('')\n    const [notFound, setNotFound] = useState()\n    const [sorted, setSorted] = useState(false)\n    const [resultsFetched, setResultsFetched] = useState(false)\n    const [userDataFetched, setUserDataFetched] = useState(false)\n\n    const [userData, setUserData] = useState({\n        name: '',\n        surname: '',\n        login: '',\n        type: '',\n        pic: '',\n        birthdate: ''\n    })\n    const [userEditedData, setUserEditedData] = useState({\n        pic: ''\n    })\n\n    const showAll = () => {\n        let shownSize = []\n        for (let i = 0; i < results.length; i++){\n            shownSize.push(i)\n        }\n        setShown([...shownSize])\n    }\n\n\n    const fetchUserData = useCallback(async () => {\n        try {\n            const fetched = await request(`/users/get/${username}`, 'GET', null, {\n                Authorization: `Bearer ${token}`\n            })\n            setUserData(fetched)\n            setUserEditedData(fetched)\n            setUserDataFetched(true)\n        }\n        catch (e) {}\n    }, [token, username])\n\n    const fetchResults = useCallback(async () => {\n        try {\n            const fetched = await request(`/results/${username}`, 'GET', null, {\n                Authorization: `Bearer ${token}`\n            })\n\n            fetched.sort((a, b) => a.result[0].date > b.result[0].date ? 1 : -1);\n            setResults(fetched)\n            setResultsFetched(true)\n        }\n        catch (e) {}\n    }, [token, userID, username])\n\n\n    const handleSearchActivating = e => {\n        e.preventDefault()\n        switch (isSearching){\n            case 'active':\n                activateSearching('inactive');\n                break\n            case 'none':\n            case 'inactive':\n                activateSearching('active');\n                document.getElementById('search').focus()\n                break\n        }\n    }\n\n    const doSearch = e => {\n        e.preventDefault()\n        try {\n            let searchFilter = e.target.value.toString().toLowerCase()\n            setSearch(searchFilter)\n            setNotFound(false)\n            if (searchFilter != '') {\n                let resultsArray = []\n                results.map(result => {\n                    let res = ''\n                    result.result.map(r => {\n                        res += r.scaleResult.toString()\n                    })\n                    resultsArray.push((result.test + res).toString().toLowerCase())\n                })\n\n                let indexes = []\n                resultsArray.map((result, i) => {\n                    if (resultsArray[i].toString().includes(searchFilter))\n                        indexes.push(i)\n                })\n\n                if (indexes.length != 0) {\n                    setShown([...indexes])\n                    setNotFound(false)\n                }\n                else setNotFound(true)\n            }\n            else showAll()\n        }\n        catch (e) {}\n    }\n\n    const doSort = e => {\n        e.preventDefault()\n        try {\n            switch (sorted) {\n                case true:\n                    document.getElementById('sortIcon').style = 'transform: rotate(360deg);'\n                    document.getElementById('resultsCollection').style = 'flex-direction: column;'\n                    setSorted(false);\n                    break;\n                case false:\n                    document.getElementById('sortIcon').style = 'transform: rotate(180deg);'\n                    document.getElementById('resultsCollection').style = 'flex-direction: column-reverse;'\n                    setSorted(true);\n                    break;\n            }\n        }\n        catch (e) {}\n    }\n\n    const handleEditActivating = e => {\n        e.preventDefault()\n        activateEditing(!isEditing);\n    }\n\n    const handleEditing = e => {\n        e.preventDefault()\n        setUserEditedData({...userEditedData, [e.target.name]: e.target.value})\n    }\n\n    const handleChooseEmojiActivating = e => {\n        e.preventDefault()\n        activateChoosingEmoji(!isChoosingEmoji)\n    }\n\n    const saveEditedData = async(e) => {\n        e.persist()\n        try {\n                const data = await request('/users/edit', 'POST', {...userEditedData, oldLogin: userData.login})\n                console.log(data.message)\n                setUserData(userEditedData)\n        }\n        catch (e) {}\n    }\n\n    const setUserPic = e => {\n        e.preventDefault()\n        setUserEditedData({...userEditedData, pic: emojis[e.target.id.slice(1)]})\n        saveEditedData(e)\n    }\n\n\n    useEffect(() => {\n        document.body.style = 'transition-duration: .7s; transition-timing-function: ease-in-out; background: white;'\n\n        //   // !resultsFetched && username !== userData.login && fetchResults()\n        //   // !userDataFetched && username !== userData.login && fetchUserData()\n\n        fetchUserData()\n        fetchResults()\n\n        if (shown.length == 0) showAll()\n\n    }, [resultsFetched, userDataFetched, username])\n\n\n\n    const emojiToString = arr => {\n        let str = ''\n        if (arr){\n            for (let i = 0; i < arr.length; i++) {\n                return  String.fromCodePoint(arr[i])\n            }\n        }\n        return str\n    }\n\n\n    return (\n        <div>\n            <div className = 'profileContainer'>\n\n                <div className = 'profileEditingPic' onClick = {e => handleChooseEmojiActivating(e)}> {emojiToString(userEditedData.pic)} </div>\n                {isChoosingEmoji &&\n                    <div className = 'emojiContainerOnProfile'>\n                        <div className = 'profileEditingPic' onClick = {e => handleChooseEmojiActivating(e)}> {emojiToString(userEditedData.pic)} </div>\n                        {\n                            emojis.map((emoji, i) => {\n                                return (\n                                    <div className = 'addingStudentEmoji' onClick = {e => setUserPic(e)} key = {i} id = {'e' + i}>\n                                        {emojiToString(emoji)}\n                                    </div>\n                                )\n                            })\n                        }\n                    </div>\n                }\n\n                <div className = 'profileHeader'>\n\n                    <h1 id = 'fio'>{userData.name} {userData.surname}</h1>\n                    <h2 id = 'loginOnProfile'>{userData.login}</h2>\n\n                    {userData.type === 's' &&\n                    <h3 id = 'type'>Ученик</h3>}\n\n                    {\n                        isEditing &&\n\n                        <div id = 'saveAndCancelEditing'>\n\n                            <svg id = 'cancelIcon' onClick = {e => cancelEditing(e)} width=\"35px\" height=\"35px\" viewBox=\"0 0 300 300\" version=\"1.1\">\n                                <g fill=\"#E88732\"  id=\"Logo\" stroke=\"none\" stroke-width=\"1\" fill-rule=\"evenodd\">\n                                    <path d=\"M231.885822,72.3223305 C241.64893,82.0854378 241.64893,97.9145622 231.885822,107.67767 L184.959,154.604 L222.885822,192.530483 C232.64893,202.293591 232.64893,218.122715 222.885822,227.885822 C213.122715,237.64893 197.293591,237.64893 187.530483,227.885822 L149.604,189.959 L111.67767,227.885822 C101.914562,237.64893 86.0854378,237.64893 76.3223305,227.885822 C66.5592232,218.122715 66.5592232,202.293591 76.3223305,192.530483 L114.249,154.604 L67.3223305,107.67767 C57.5592232,97.9145622 57.5592232,82.0854378 67.3223305,72.3223305 C77.0854378,62.5592232 92.9145622,62.5592232 102.67767,72.3223305 L149.604,119.249 L196.530483,72.3223305 C206.293591,62.5592232 222.122715,62.5592232 231.885822,72.3223305 Z\" id=\"Combined-Shape\"></path>\n                                </g>\n                            </svg>\n\n                            <svg id = 'saveIcon' onClick = {e => saveEditedData(e)} width=\"30px\" height=\"30px\" viewBox=\"0 0 300 300\" version=\"1.1\">\n                                <g id=\"Logo\" fill=\"#E0E7B4\" stroke=\"none\" stroke-width=\"1\" fill-rule=\"evenodd\">\n                                    <path d=\"M274.847645,60.3120342 L279.170453,64.6298082 C288.939247,74.3872257 288.948469,90.2163475 279.191052,99.9851413 C279.18419,99.9920115 279.177324,99.9988777 279.170453,100.00574 L151.781477,227.246365 C146.461489,232.560158 139.343499,234.977726 132.387469,234.499068 C125.431382,234.977957 118.312965,232.560413 112.992721,227.246365 L21.3326328,135.693019 C11.563839,125.935602 11.5546167,110.10648 21.3120342,100.337686 L21.3326328,100.317087 L21.3326328,100.317087 L25.655441,95.9993134 C35.4161868,86.2499345 51.2294296,86.2499345 60.9901754,95.9993134 L132.387,167.312 L239.512911,60.3120342 C249.273657,50.5626553 265.086899,50.5626553 274.847645,60.3120342 Z\" id=\"Combined-Shape\"></path>\n                                </g>\n                            </svg>\n\n                        </div>\n                    }\n\n                </div>\n            </div>\n\n            {results.length != 0 &&\n            <div className = 'searchAndSort'>\n                <input type = 'text' id = 'search'\n                       className = {  isSearching === 'active' && 'searchAppearing' ||\n                       isSearching === 'inactive' && 'searchDisappearing' ||\n                       isSearching === 'none' && 'invisible'}\n                       placeholder = 'Поиск по результатам' onChange = {doSearch}/>\n\n                <svg className = 'searchIcon' name = 'searchIcon' width=\"250px\" height=\"277px\" viewBox=\"0 0 250 277\" version=\"1.1\"\n                     onClick = {handleSearchActivating}>\n                    <g id=\"Logo\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n                        <path className = {   isSearching === 'active' && 'activeStroke activeFill' ||\n                        isSearching === 'inactive' && 'inactiveStroke inactiveFill' ||\n                        isSearching === 'none' && 'inactiveStroke inactiveFill'}\n                              d=\"M256.23536,245.633373 C256.240323,245.854751 256.242819,246.076789 256.242819,246.299457 C256.242819,261.211145 245.049938,273.299457 231.242819,273.299457 C217.4357,273.299457 206.242819,261.211145 206.242819,246.299457 C206.242819,246.076789 206.245315,245.854751 206.250278,245.633373 Z\" id=\"Combined-Shape\" transform=\"translate(231.242819, 259.466415) rotate(-40.000000) translate(-231.242819, -259.466415) \"></path>\n                        <rect id=\"Rectangle\"\n                              className = {   isSearching === 'active' && 'activeStroke activeFill' ||\n                              isSearching === 'inactive' && 'inactiveStroke inactiveFill' ||\n                              isSearching === 'none' && 'inactiveStroke inactiveFill'}\n                              transform=\"translate(199.856726, 222.096267) rotate(-40.000000) translate(-199.856726, -222.096267) \" x=\"174.856726\" y=\"186.596267\" width=\"50\" height=\"71\"></rect>\n                        <circle id=\"Oval\"\n                                className = {   isSearching === 'active' && 'activeStroke' ||\n                                isSearching === 'inactive' && 'inactiveStroke' ||\n                                isSearching === 'none' && 'inactiveStroke'}\n                                stroke-width=\"50\" cx=\"125\" cy=\"125\" r=\"100\"></circle>\n                    </g>\n                </svg>\n\n                <svg className = 'sortIcon' id = 'sortIcon' onClick = {doSort} width=\"378px\" height=\"282px\" viewBox=\"0 0 378 282\" version=\"1.1\">\n                    <g id=\"Logo\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n                        <path d=\"M96.0389392,1 C106.609669,1 115.859436,5.58308193 120.9273,12.4308996 L121.015825,12.5525321 L184.479,88.185 L184.496508,88.1714212 C184.642609,88.3378163 184.787245,88.5063032 184.930373,88.6768766 C194.515421,100.099893 193.711394,116.554722 183.134527,125.429767 C172.70048,134.184972 156.653546,132.29306 147.020097,121.273869 L146.992363,121.296357 L121.038,90.365 L121.038939,199 L121.03148,199 C121.036443,199.221378 121.038939,199.443416 121.038939,199.666084 C121.038939,214.577772 109.846058,226.666084 96.0389392,226.666084 C82.2318205,226.666084 71.0389392,214.577772 71.0389392,199.666084 C71.0389392,199.443416 71.041435,199.221378 71.0463979,199 L71.0389392,199 L71.038,90.942 L46.409,120.293 L46.4188636,120.301213 C46.2803665,120.473988 46.1395549,120.645684 45.9964268,120.816257 C36.4113784,132.239273 20.0669169,134.304812 9.49005029,125.429767 C-0.91459931,116.699229 -1.8620698,100.633732 7.23426161,89.2388073 L7.21214233,89.2211541 L69.5356122,14.9464184 C74.0533978,6.728782 84.2205763,1 96.0389392,1 Z\" id=\"Combined-Shape\"\n                              stroke=\"#4A4A4A\" fill=\"#4A4A4A\"></path>\n                        <path d=\"M282.185638,55 C294.279566,55 304.644412,60.9990492 308.99572,69.5252612 L370.259061,142.536 L370.296508,142.505337 C370.442609,142.671732 370.587245,142.840219 370.730373,143.010793 C380.315421,154.433809 379.511394,170.888638 368.934527,179.763683 C358.495096,188.523405 342.436985,186.625021 332.805192,175.590722 L332.757304,175.630273 L306.803061,144.699 L306.80388,253.333916 L306.796421,253.333916 C306.801384,253.555294 306.80388,253.777332 306.80388,254 C306.80388,268.911688 295.610999,281 281.80388,281 C267.996761,281 256.80388,268.911688 256.80388,254 C256.80388,253.777332 256.806376,253.555294 256.811339,253.333916 L256.80388,253.333916 L256.803061,145.276 L232.172061,174.629 L232.179924,174.635129 C232.041427,174.807904 231.900616,174.9796 231.757488,175.150173 C222.172439,186.573189 205.827978,188.638728 195.251111,179.763683 C184.845967,171.03273 183.898901,154.96612 192.99662,143.571098 L192.977083,143.55507 L255.890594,68.5762614 C260.507198,60.5572584 270.545545,55 282.185638,55 Z\" id=\"Combined-Shape-Copy-10\"\n                              stroke=\"#D6D6D6\" fill=\"#D6D6D6\" transform=\"translate(282.092819, 168.000000) rotate(180.000000) translate(-282.092819, -168.000000) \"></path>\n                    </g>\n                </svg>\n\n\n\n            </div>\n            }\n\n            <div id = 'resultsCollection' className = 'results'>\n                {\n                    notFound && <h1 className = 'notFound'>Ничего не найдено</h1> ||\n                    !notFound &&\n                    results.map((result, index) => {\n                        if (shown.includes(index)){\n                            return (\n                                <NavLink to={'/'} key={index} className='resultItem soft_appearing'>\n                                    <p className='resultTestName'>{result.test}</p>\n                                    <div className='shortResult'>\n                                        {\n                                            result.result.map((result, i) => {\n                                                    return (\n                                                        <p key={i}>{result.scaleResult}</p>\n                                                    )\n                                                }\n                                            )}\n                                    </div>\n                                </NavLink>\n                            )}\n                    })\n                }\n            </div>\n\n        </div>\n    )\n\n\n}\n\nexport default Profile;"]},"metadata":{},"sourceType":"module"}