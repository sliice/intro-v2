{"ast":null,"code":"var _jsxFileName = \"/Users/alisakrylova/Intro2/client/src/components/ProfileViewForStudents.js\";\nimport React, { useCallback, useContext, useEffect, useState } from 'react';\nimport { useParams, useHistory } from \"react-router-dom\";\nimport './Appearence/Profile.css';\nimport './Appearence/index.css';\nimport { AuthContext } from \"./Context/AuthContext\";\nimport { useHttp } from \"../Hooks/Http.hook\";\nimport { NavLink } from \"react-router-dom\";\nimport { emojis, emojiToString } from \"./Functions and const/Emoji\";\nimport notify from \"./Functions and const/Notify\";\nimport SearchIcon from \"./Appearence/Images/SearchIcon\";\nexport const ProfileViewForStudents = () => {\n  let login = useParams().id;\n  const history = useHistory();\n  const {\n    loading,\n    request\n  } = useHttp();\n  const {\n    token,\n    username\n  } = useContext(AuthContext);\n  const [results, setResults] = useState([]);\n  const [shown, setShown] = useState([]);\n  const [isSearching, activateSearching] = useState('none');\n  const [isChoosingEmoji, activateChoosingEmoji] = useState(false);\n  const [search, setSearch] = useState('');\n  const [notFound, setNotFound] = useState();\n  const [sorted, setSorted] = useState(false);\n  const [resultsFetched, setResultsFetched] = useState(false);\n  const [userDataFetched, setUserDataFetched] = useState(false);\n  if (login !== username) history.push('/');\n  const [userData, setUserData] = useState({\n    name: '',\n    surname: '',\n    login: '',\n    type: '',\n    pic: '',\n    birthdate: ''\n  });\n  const [userEditedData, setUserEditedData] = useState({\n    pic: ''\n  });\n\n  const showAll = () => {\n    let shownSize = [];\n\n    for (let i = 0; i < results.length; i++) {\n      shownSize.push(i);\n    }\n\n    setShown([...shownSize]);\n  };\n\n  const fetchUserData = useCallback(async () => {\n    try {\n      const fetched = await request(`/api/users/get/${username}`, 'GET', null, {\n        Authorization: `Bearer ${token}`\n      });\n      setUserData(fetched);\n      setUserEditedData(fetched);\n      setUserDataFetched(true);\n      if (fetched) document.title = fetched.name + ' ' + fetched.surname;\n    } catch (e) {}\n  }, [token, username]);\n  const fetchResults = useCallback(async () => {\n    try {\n      const fetched = await request(`/api/results/${username}`, 'GET', null, {\n        Authorization: `Bearer ${token}`\n      });\n      fetched.sort((a, b) => a.date < b.date ? 1 : -1);\n      setResults(fetched);\n      setResultsFetched(true);\n    } catch (e) {}\n  }, [token, username]);\n\n  const handleSearchActivating = e => {\n    e.preventDefault();\n\n    switch (isSearching) {\n      case 'active':\n        activateSearching('inactive');\n        break;\n\n      case 'none':\n      case 'inactive':\n        activateSearching('active');\n        document.getElementById('search').focus();\n        break;\n    }\n  };\n\n  const doSearch = e => {\n    e.preventDefault();\n\n    try {\n      let searchFilter = e.target.value.toString().toLowerCase();\n      setSearch(searchFilter);\n      setNotFound(false);\n\n      if (searchFilter != '') {\n        let resultsArray = [];\n        results.map(result => {\n          let res = '';\n          result.scales.map(r => {\n            res += r.toString();\n          });\n          resultsArray.push((result.test + res).toString().toLowerCase());\n        });\n        let indexes = [];\n        resultsArray.map((result, i) => {\n          if (resultsArray[i].toString().includes(searchFilter)) indexes.push(i);\n        });\n\n        if (indexes.length != 0) {\n          setNotFound(false);\n        } else setNotFound(true);\n      }\n    } catch (e) {}\n  };\n\n  const doSort = e => {\n    e.preventDefault();\n\n    try {\n      switch (sorted) {\n        case true:\n          document.getElementById('sortIcon').style = 'transform: rotate(360deg);';\n          document.getElementById('resultsCollection').style = 'flex-direction: column;';\n          setSorted(false);\n          break;\n\n        case false:\n          document.getElementById('sortIcon').style = 'transform: rotate(180deg);';\n          document.getElementById('resultsCollection').style = 'flex-direction: column-reverse;';\n          setSorted(true);\n          break;\n      }\n    } catch (e) {}\n  };\n\n  const handleChooseEmojiActivating = e => {\n    e.preventDefault();\n    activateChoosingEmoji(!isChoosingEmoji);\n  };\n\n  const saveEditedData = async e => {\n    e.persist();\n\n    try {\n      const data = await request('/api/users/edit', 'POST', { ...userData,\n        oldLogin: userData.login,\n        pic: emojis[e.target.id.slice(1)]\n      });\n      setUserData({ ...userData,\n        pic: emojis[e.target.id.slice(1)]\n      });\n      if (data.message === 'User\\'ve edited') notify('Новый эмоджи профиля установлен');\n    } catch (e) {}\n  };\n\n  useEffect(() => {\n    document.body.style = 'transition-duration: .7s; transition-timing-function: ease-in-out; background: white;';\n    fetchUserData();\n    fetchResults();\n    if (shown.length == 0) showAll();\n  }, [username, resultsFetched, userDataFetched]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profileContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profileEditingPic\",\n    onClick: e => handleChooseEmojiActivating(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 17\n    }\n  }, \" \", emojiToString(userData.pic), \" \"), isChoosingEmoji && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"emojiContainerOnProfile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profileEditingPic\",\n    onClick: e => handleChooseEmojiActivating(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 25\n    }\n  }, \" \", emojiToString(userData.pic), \" \"), emojis.map((emoji, i) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"addingStudentEmoji\",\n      onClick: e => saveEditedData(e),\n      key: i,\n      id: 'e' + i,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 37\n      }\n    }, emojiToString(emoji));\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profileHeader\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    id: \"fio\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 21\n    }\n  }, userData.name, \" \", userData.surname), /*#__PURE__*/React.createElement(\"h2\", {\n    id: \"loginOnProfile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 21\n    }\n  }, userData.login), userData.type === 's' && /*#__PURE__*/React.createElement(\"h3\", {\n    id: \"type\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 21\n    }\n  }, \"\\u0423\\u0447\\u0435\\u043D\\u0438\\u043A\"))), results.length != 0 && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"searchAndSort\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"search\",\n    className: isSearching === 'active' && 'searchAppearing' || isSearching === 'inactive' && 'searchDisappearing' || isSearching === 'none' && 'invisible',\n    placeholder: \"\\u041F\\u043E\\u0438\\u0441\\u043A \\u043F\\u043E \\u0440\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442\\u0430\\u043C\",\n    onChange: doSearch,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 17\n    }\n  }), SearchIcon({\n    handleSearchActivating\n  }), /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"sortIcon\",\n    id: \"sortIcon\",\n    onClick: doSort,\n    width: \"378px\",\n    height: \"282px\",\n    viewBox: \"0 0 378 282\",\n    version: \"1.1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Logo\",\n    stroke: \"none\",\n    \"stroke-width\": \"1\",\n    fill: \"none\",\n    \"fill-rule\": \"evenodd\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M96.0389392,1 C106.609669,1 115.859436,5.58308193 120.9273,12.4308996 L121.015825,12.5525321 L184.479,88.185 L184.496508,88.1714212 C184.642609,88.3378163 184.787245,88.5063032 184.930373,88.6768766 C194.515421,100.099893 193.711394,116.554722 183.134527,125.429767 C172.70048,134.184972 156.653546,132.29306 147.020097,121.273869 L146.992363,121.296357 L121.038,90.365 L121.038939,199 L121.03148,199 C121.036443,199.221378 121.038939,199.443416 121.038939,199.666084 C121.038939,214.577772 109.846058,226.666084 96.0389392,226.666084 C82.2318205,226.666084 71.0389392,214.577772 71.0389392,199.666084 C71.0389392,199.443416 71.041435,199.221378 71.0463979,199 L71.0389392,199 L71.038,90.942 L46.409,120.293 L46.4188636,120.301213 C46.2803665,120.473988 46.1395549,120.645684 45.9964268,120.816257 C36.4113784,132.239273 20.0669169,134.304812 9.49005029,125.429767 C-0.91459931,116.699229 -1.8620698,100.633732 7.23426161,89.2388073 L7.21214233,89.2211541 L69.5356122,14.9464184 C74.0533978,6.728782 84.2205763,1 96.0389392,1 Z\",\n    id: \"Combined-Shape\",\n    stroke: \"#4A4A4A\",\n    fill: \"#4A4A4A\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M282.185638,55 C294.279566,55 304.644412,60.9990492 308.99572,69.5252612 L370.259061,142.536 L370.296508,142.505337 C370.442609,142.671732 370.587245,142.840219 370.730373,143.010793 C380.315421,154.433809 379.511394,170.888638 368.934527,179.763683 C358.495096,188.523405 342.436985,186.625021 332.805192,175.590722 L332.757304,175.630273 L306.803061,144.699 L306.80388,253.333916 L306.796421,253.333916 C306.801384,253.555294 306.80388,253.777332 306.80388,254 C306.80388,268.911688 295.610999,281 281.80388,281 C267.996761,281 256.80388,268.911688 256.80388,254 C256.80388,253.777332 256.806376,253.555294 256.811339,253.333916 L256.80388,253.333916 L256.803061,145.276 L232.172061,174.629 L232.179924,174.635129 C232.041427,174.807904 231.900616,174.9796 231.757488,175.150173 C222.172439,186.573189 205.827978,188.638728 195.251111,179.763683 C184.845967,171.03273 183.898901,154.96612 192.99662,143.571098 L192.977083,143.55507 L255.890594,68.5762614 C260.507198,60.5572584 270.545545,55 282.185638,55 Z\",\n    id: \"Combined-Shape-Copy-10\",\n    stroke: \"#D6D6D6\",\n    fill: \"#D6D6D6\",\n    transform: \"translate(282.092819, 168.000000) rotate(180.000000) translate(-282.092819, -168.000000) \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 25\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"resultsCollection\",\n    className: \"results\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 13\n    }\n  }, notFound && /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"notFound\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 33\n    }\n  }, \"\\u041D\\u0438\\u0447\\u0435\\u0433\\u043E \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E\") || !notFound && results.map((result, index) => {\n    if ((result.test + result.scales).toLowerCase().includes(search)) return /*#__PURE__*/React.createElement(NavLink, {\n      to: `/tests/${result.link}/${username}`,\n      key: index,\n      className: \"resultItem soft_appearing\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: \"resultTestName\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 33\n      }\n    }, result.test), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"shortResult\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 33\n      }\n    }, result.scales.map((res, i) => {\n      return /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 49\n        }\n      }, res);\n    })));\n  }), !notFound && !results[0] && /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"notFound\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 21\n    }\n  }, \"\\u0420\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442\\u043E\\u0432 \\u043F\\u043E\\u043A\\u0430 \\u043D\\u0435\\u0442\")));\n};\nexport default ProfileViewForStudents;","map":{"version":3,"sources":["/Users/alisakrylova/Intro2/client/src/components/ProfileViewForStudents.js"],"names":["React","useCallback","useContext","useEffect","useState","useParams","useHistory","AuthContext","useHttp","NavLink","emojis","emojiToString","notify","SearchIcon","ProfileViewForStudents","login","id","history","loading","request","token","username","results","setResults","shown","setShown","isSearching","activateSearching","isChoosingEmoji","activateChoosingEmoji","search","setSearch","notFound","setNotFound","sorted","setSorted","resultsFetched","setResultsFetched","userDataFetched","setUserDataFetched","push","userData","setUserData","name","surname","type","pic","birthdate","userEditedData","setUserEditedData","showAll","shownSize","i","length","fetchUserData","fetched","Authorization","document","title","e","fetchResults","sort","a","b","date","handleSearchActivating","preventDefault","getElementById","focus","doSearch","searchFilter","target","value","toString","toLowerCase","resultsArray","map","result","res","scales","r","test","indexes","includes","doSort","style","handleChooseEmojiActivating","saveEditedData","persist","data","oldLogin","slice","message","body","emoji","index","link"],"mappings":"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","sourcesContent":["import React, {useCallback, useContext, useEffect, useState} from 'react'\nimport {useParams, useHistory} from \"react-router-dom\";\nimport './Appearence/Profile.css'\nimport './Appearence/index.css'\nimport {AuthContext} from \"./Context/AuthContext\"\nimport {useHttp} from \"../Hooks/Http.hook\"\nimport {NavLink} from \"react-router-dom\"\nimport {emojis, emojiToString} from \"./Functions and const/Emoji\";\nimport notify from \"./Functions and const/Notify\";\nimport SearchIcon from \"./Appearence/Images/SearchIcon\";\n\nexport const ProfileViewForStudents = () => {\n\n    let login = useParams().id\n\n    const history = useHistory()\n\n    const {loading, request} = useHttp();\n    const {token, username} = useContext(AuthContext)\n    const [results, setResults] = useState([])\n    const [shown, setShown] = useState([])\n    const [isSearching, activateSearching] = useState('none')\n    const [isChoosingEmoji, activateChoosingEmoji] = useState(false)\n    const [search, setSearch] = useState('')\n    const [notFound, setNotFound] = useState()\n    const [sorted, setSorted] = useState(false)\n    const [resultsFetched, setResultsFetched] = useState(false)\n    const [userDataFetched, setUserDataFetched] = useState(false)\n\n    if (login !== username)\n        history.push('/')\n\n    const [userData, setUserData] = useState({\n        name: '',\n        surname: '',\n        login: '',\n        type: '',\n        pic: '',\n        birthdate: ''\n    })\n    const [userEditedData, setUserEditedData] = useState({\n        pic: ''\n    })\n\n    const showAll = () => {\n        let shownSize = []\n        for (let i = 0; i < results.length; i++){\n            shownSize.push(i)\n        }\n        setShown([...shownSize])\n    }\n\n\n    const fetchUserData = useCallback(async () => {\n        try {\n            const fetched = await request(`/api/users/get/${username}`, 'GET', null, {\n                Authorization: `Bearer ${token}`\n            })\n            setUserData(fetched)\n            setUserEditedData(fetched)\n            setUserDataFetched(true)\n            if (fetched) document.title = fetched.name + ' ' + fetched.surname\n        }\n        catch (e) {}\n    }, [token, username])\n\n    const fetchResults = useCallback(async () => {\n        try {\n            const fetched = await request(`/api/results/${username}`, 'GET', null, {\n                Authorization: `Bearer ${token}`\n            })\n\n            fetched.sort((a, b) => a.date < b.date ? 1 : -1)\n            setResults(fetched)\n            setResultsFetched(true)\n        }\n        catch (e) {}\n    }, [token, username])\n\n\n    const handleSearchActivating = e => {\n        e.preventDefault()\n        switch (isSearching){\n            case 'active':\n                activateSearching('inactive');\n                break\n            case 'none':\n            case 'inactive':\n                activateSearching('active');\n                document.getElementById('search').focus()\n                break\n        }\n    }\n\n    const doSearch = e => {\n        e.preventDefault()\n        try {\n            let searchFilter = e.target.value.toString().toLowerCase()\n            setSearch(searchFilter)\n            setNotFound(false)\n            if (searchFilter != '') {\n                let resultsArray = []\n                results.map(result => {\n                    let res = ''\n                    result.scales.map(r => {\n                        res += r.toString()\n                    })\n                    resultsArray.push((result.test + res).toString().toLowerCase())\n                })\n\n                let indexes = []\n                resultsArray.map((result, i) => {\n                    if (resultsArray[i].toString().includes(searchFilter))\n                        indexes.push(i)\n                })\n\n                if (indexes.length != 0) {\n                    setNotFound(false)\n                }\n                else setNotFound(true)\n            }\n        }\n        catch (e) {}\n    }\n\n    const doSort = e => {\n        e.preventDefault()\n        try {\n            switch (sorted) {\n                case true:\n                    document.getElementById('sortIcon').style = 'transform: rotate(360deg);'\n                    document.getElementById('resultsCollection').style = 'flex-direction: column;'\n                    setSorted(false);\n                    break;\n                case false:\n                    document.getElementById('sortIcon').style = 'transform: rotate(180deg);'\n                    document.getElementById('resultsCollection').style = 'flex-direction: column-reverse;'\n                    setSorted(true);\n                    break;\n            }\n        }\n        catch (e) {}\n    }\n\n    const handleChooseEmojiActivating = e => {\n        e.preventDefault()\n        activateChoosingEmoji(!isChoosingEmoji)\n    }\n\n    const saveEditedData = async(e) => {\n        e.persist()\n        try {\n            const data = await request('/api/users/edit', 'POST', {...userData, oldLogin: userData.login, pic: emojis[e.target.id.slice(1)]})\n            setUserData({...userData, pic: emojis[e.target.id.slice(1)]})\n            if (data.message === 'User\\'ve edited') notify('Новый эмоджи профиля установлен')\n        }\n        catch (e) {}\n    }\n\n\n    useEffect(() => {\n        document.body.style = 'transition-duration: .7s; transition-timing-function: ease-in-out; background: white;'\n\n        fetchUserData()\n        fetchResults()\n\n        if (shown.length == 0) showAll()\n\n    }, [username, resultsFetched, userDataFetched])\n\n\n    return (\n        <div>\n            <div className = 'profileContainer'>\n\n                <div className = 'profileEditingPic' onClick = {e => handleChooseEmojiActivating(e)}> {emojiToString(userData.pic)} </div>\n                {isChoosingEmoji &&\n                    <div className = 'emojiContainerOnProfile'>\n                        <div className = 'profileEditingPic' onClick = {e => handleChooseEmojiActivating(e)}> {emojiToString(userData.pic)} </div>\n                        {\n                            emojis.map((emoji, i) => {\n                                return (\n                                    <div className = 'addingStudentEmoji' onClick = {e => saveEditedData(e)} key = {i} id = {'e' + i}>\n                                        {emojiToString(emoji)}\n                                    </div>\n                                )\n                            })\n                        }\n                    </div>\n                }\n\n                <div className = 'profileHeader'>\n\n                    <h1 id = 'fio'>{userData.name} {userData.surname}</h1>\n                    <h2 id = 'loginOnProfile'>{userData.login}</h2>\n\n                    {userData.type === 's' &&\n                    <h3 id = 'type'>Ученик</h3>}\n\n                </div>\n            </div>\n\n            {results.length != 0 &&\n            <div className = 'searchAndSort'>\n                <input type = 'text' id = 'search'\n                       className = {  isSearching === 'active' && 'searchAppearing' ||\n                       isSearching === 'inactive' && 'searchDisappearing' ||\n                       isSearching === 'none' && 'invisible'}\n                       placeholder = 'Поиск по результатам' onChange = {doSearch}/>\n\n                { SearchIcon({ handleSearchActivating }) }\n\n                <svg className = 'sortIcon' id = 'sortIcon' onClick = {doSort} width=\"378px\" height=\"282px\" viewBox=\"0 0 378 282\" version=\"1.1\">\n                    <g id=\"Logo\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n                        <path d=\"M96.0389392,1 C106.609669,1 115.859436,5.58308193 120.9273,12.4308996 L121.015825,12.5525321 L184.479,88.185 L184.496508,88.1714212 C184.642609,88.3378163 184.787245,88.5063032 184.930373,88.6768766 C194.515421,100.099893 193.711394,116.554722 183.134527,125.429767 C172.70048,134.184972 156.653546,132.29306 147.020097,121.273869 L146.992363,121.296357 L121.038,90.365 L121.038939,199 L121.03148,199 C121.036443,199.221378 121.038939,199.443416 121.038939,199.666084 C121.038939,214.577772 109.846058,226.666084 96.0389392,226.666084 C82.2318205,226.666084 71.0389392,214.577772 71.0389392,199.666084 C71.0389392,199.443416 71.041435,199.221378 71.0463979,199 L71.0389392,199 L71.038,90.942 L46.409,120.293 L46.4188636,120.301213 C46.2803665,120.473988 46.1395549,120.645684 45.9964268,120.816257 C36.4113784,132.239273 20.0669169,134.304812 9.49005029,125.429767 C-0.91459931,116.699229 -1.8620698,100.633732 7.23426161,89.2388073 L7.21214233,89.2211541 L69.5356122,14.9464184 C74.0533978,6.728782 84.2205763,1 96.0389392,1 Z\" id=\"Combined-Shape\"\n                              stroke=\"#4A4A4A\" fill=\"#4A4A4A\"></path>\n                        <path d=\"M282.185638,55 C294.279566,55 304.644412,60.9990492 308.99572,69.5252612 L370.259061,142.536 L370.296508,142.505337 C370.442609,142.671732 370.587245,142.840219 370.730373,143.010793 C380.315421,154.433809 379.511394,170.888638 368.934527,179.763683 C358.495096,188.523405 342.436985,186.625021 332.805192,175.590722 L332.757304,175.630273 L306.803061,144.699 L306.80388,253.333916 L306.796421,253.333916 C306.801384,253.555294 306.80388,253.777332 306.80388,254 C306.80388,268.911688 295.610999,281 281.80388,281 C267.996761,281 256.80388,268.911688 256.80388,254 C256.80388,253.777332 256.806376,253.555294 256.811339,253.333916 L256.80388,253.333916 L256.803061,145.276 L232.172061,174.629 L232.179924,174.635129 C232.041427,174.807904 231.900616,174.9796 231.757488,175.150173 C222.172439,186.573189 205.827978,188.638728 195.251111,179.763683 C184.845967,171.03273 183.898901,154.96612 192.99662,143.571098 L192.977083,143.55507 L255.890594,68.5762614 C260.507198,60.5572584 270.545545,55 282.185638,55 Z\" id=\"Combined-Shape-Copy-10\"\n                              stroke=\"#D6D6D6\" fill=\"#D6D6D6\" transform=\"translate(282.092819, 168.000000) rotate(180.000000) translate(-282.092819, -168.000000) \"></path>\n                    </g>\n                </svg>\n\n\n\n            </div>\n            }\n\n            <div id = 'resultsCollection' className = 'results'>\n                {\n                    notFound && <h1 className = 'notFound'>Ничего не найдено</h1> ||\n                    !notFound &&\n                    results.map((result, index) => {\n                        if ((result.test + result.scales).toLowerCase().includes(search))\n                        return (\n                            <NavLink to={`/tests/${result.link}/${username}`} key={index} className='resultItem soft_appearing'>\n                                <p className='resultTestName'>{result.test}</p>\n                                <div className='shortResult'>\n                                    {\n                                        result.scales.map((res, i) => {\n                                            return (\n                                                <p>{res}</p>\n                                            )\n                                        })\n                                    }\n                                </div>\n                            </NavLink>\n                        )\n                    })\n                }\n                {\n                    !notFound && !results[0] &&\n                    <h1 className = 'notFound'>Результатов пока нет</h1>\n                }\n            </div>\n\n        </div>\n    )\n\n\n}\n\nexport default ProfileViewForStudents"]},"metadata":{},"sourceType":"module"}